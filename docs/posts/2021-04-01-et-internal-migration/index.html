<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

<style>
  div.csl-bib-body { }
  div.csl-entry {
    clear: both;
    }
  .hanging div.csl-entry {
    margin-left:2em;
    text-indent:-2em;
  }
  div.csl-left-margin {
    min-width:2em;
    float:left;
  }
  div.csl-right-inline {
    margin-left:2em;
    padding-left:1em;
  }
  div.csl-indent {
    margin-left: 2em;
  }
</style>

  <!--radix_placeholder_meta_tags-->
<title>Data Analysis Hub: Unmet need for family planning after internal migration</title>

<meta property="description" itemprop="description" content="Summary and source code from a recent article using data from Ethiopia."/>

<link rel="canonical" href="https://ipums.github.io/pma-data-hub/posts/2021-04-01-et-internal-migration/"/>
<link rel="icon" type="image/png" href="../../images/favicon/favicon-32x32.png"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-04-02"/>
<meta property="article:created" itemprop="dateCreated" content="2021-04-02"/>
<meta name="article:author" content="Matt Gunther"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Data Analysis Hub: Unmet need for family planning after internal migration"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Summary and source code from a recent article using data from Ethiopia."/>
<meta property="og:url" content="https://ipums.github.io/pma-data-hub/posts/2021-04-01-et-internal-migration/"/>
<meta property="og:image" content="https://ipums.github.io/pma-data-hub/posts/2021-04-01-et-internal-migration/images/pred_prob_h4.png"/>
<meta property="og:image:width" content="2683"/>
<meta property="og:image:height" content="1200"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Data Analysis Hub"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Data Analysis Hub: Unmet need for family planning after internal migration"/>
<meta property="twitter:description" content="Summary and source code from a recent article using data from Ethiopia."/>
<meta property="twitter:url" content="https://ipums.github.io/pma-data-hub/posts/2021-04-01-et-internal-migration/"/>
<meta property="twitter:image" content="https://ipums.github.io/pma-data-hub/posts/2021-04-01-et-internal-migration/images/pred_prob_h4.png"/>
<meta property="twitter:image:width" content="2683"/>
<meta property="twitter:image:height" content="1200"/>
<meta property="twitter:site" content="@ipumsGH"/>

<!--/radix_placeholder_meta_tags-->
  
  <meta name="citation_reference" content="citation_title=The fertility of internal migrants to kinshasa;citation_publication_date=2017;citation_volume=73;citation_author=Philip Anglewicz;citation_author=Jamaica Corker;citation_author=Patrick Kayembe"/>
  <meta name="citation_reference" content="citation_title=Unmet need for family planning after internal migration: Analysis of ethiopia 2017–2018 PMA survey data;citation_publication_date=2021;citation_publisher=Wiley;citation_volume=27;citation_author=Emily A Groene;citation_author=Devon Kristiansen"/>
  <meta name="citation_reference" content="citation_title=Migration and fertility: Competing hypotheses re-examined;citation_publication_date=2005;citation_publisher=Springer;citation_volume=21;citation_author=Hill Kulu"/>
  <meta name="citation_reference" content="citation_title=Family formation and urbanization;citation_publication_date=1989;citation_volume=44;citation_author=D Courgeau"/>
  <meta name="citation_reference" content="citation_title=The effect of access to contraceptive services on injectable use and demand for family planning in malawi;citation_publication_date=2015;citation_volume=41;citation_author=Martha Priedeman Skiles;citation_author=Marc Cunningham;citation_author=Andrew Inglis;citation_author=Becky Wilkes;citation_author=Ben Hatch;citation_author=Ariella Bock;citation_author=Janine Barden-O’Fallon"/>
  <meta name="citation_reference" content="citation_title=Social interactions and fluctuations in birth rates;citation_publication_date=2000;citation_publisher=Routledge;citation_volume=54;citation_author=Hans-Peter Kohler"/>
  <meta name="citation_reference" content="citation_title=Changing livelihoods, changing childhoods: Patterns of children’s work in rural southern ethiopia;citation_publication_date=2007;citation_publisher=Routledge;citation_volume=5;citation_author=Tatek Abebe"/>
  <meta name="citation_reference" content="citation_title=Human capital, family planning, and their effects on population growth;citation_publication_date=1994;citation_publisher=American Economic Association;citation_volume=84;citation_author=T Paul Schultz"/>
  <meta name="citation_reference" content="citation_title=Contraception and abortion in a low-fertility setting: The role of seasonal migration;citation_publication_date=2013;citation_volume=39;citation_author=Arusyak Sevoyan;citation_author=Victor Agadjanian"/>
  <meta name="citation_reference" content="citation_title=World migration report 2018;citation_publication_date=2017;citation_author=Marie McAuliffe;citation_author=Martin Ruhs"/>
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","categories","output","bibliography","preview","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Unmet need for family planning after internal migration"]},{"type":"character","attributes":{},"value":["Summary and source code from a recent article using data from Ethiopia."]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation"]}},"value":[{"type":"character","attributes":{},"value":["Matt Gunther"]},{"type":"character","attributes":{},"value":["IPUMS PMA Senior Data Analyst"]}]}]},{"type":"character","attributes":{},"value":["04/02/2021"]},{"type":"character","attributes":{},"value":["Migration","PMA Publications","svyglm","bootstraps"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_depth","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["et-internal-migration.bib"]},{"type":"character","attributes":{},"value":["images/pred_prob_h4.png"]},{"type":"character","attributes":{},"value":["https://ipums.github.io/pma-data-hub/posts/2021-04-01-et-internal-migration/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/et-internal-migration.do","data/pma_00019.dat.gz","data/pma_00019.xml","et-internal-migration_files/anchor-4.2.2/anchor.min.js","et-internal-migration_files/bowser-1.9.3/bowser.min.js","et-internal-migration_files/distill-2.2.21/template.v2.js","et-internal-migration_files/figure-html5/unnamed-chunk-19-1.png","et-internal-migration_files/figure-html5/unnamed-chunk-20-1.png","et-internal-migration_files/figure-html5/unnamed-chunk-21-1.png","et-internal-migration_files/figure-html5/unnamed-chunk-22-1.png","et-internal-migration_files/figure-html5/unnamed-chunk-23-1.png","et-internal-migration_files/figure-html5/unnamed-chunk-25-1.png","et-internal-migration_files/figure-html5/unnamed-chunk-26-1.png","et-internal-migration_files/figure-html5/unnamed-chunk-27-1.png","et-internal-migration_files/font-awesome-5.13.0/css/all.min.css","et-internal-migration_files/font-awesome-5.13.0/css/v4-shims.min.css","et-internal-migration_files/font-awesome-5.13.0/js/script.js","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-brands-400.eot","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-brands-400.svg","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-brands-400.ttf","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-brands-400.woff","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-brands-400.woff2","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-regular-400.eot","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-regular-400.svg","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-regular-400.ttf","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-regular-400.woff","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-regular-400.woff2","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-solid-900.eot","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-solid-900.svg","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-solid-900.ttf","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-solid-900.woff","et-internal-migration_files/font-awesome-5.13.0/webfonts/fa-solid-900.woff2","et-internal-migration_files/header-attrs-2.6/header-attrs.js","et-internal-migration_files/header-attrs-2.7/header-attrs.js","et-internal-migration_files/header-attrs-2.9/header-attrs.js","et-internal-migration_files/jquery-1.11.3/jquery.min.js","et-internal-migration_files/popper-2.6.0/popper.min.js","et-internal-migration_files/tippy-6.2.7/tippy-bundle.umd.min.js","et-internal-migration_files/tippy-6.2.7/tippy-light-border.css","et-internal-migration_files/tippy-6.2.7/tippy.css","et-internal-migration_files/tippy-6.2.7/tippy.umd.min.js","et-internal-migration_files/webcomponents-2.0.0/webcomponents.js","et-internal-migration.bib","images/pred_prob_h4.png"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
  font-size: 100%;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      const citeChild = $(this).children()[0]
      // Do not process if @xyz has been used without escaping and without bibliography activated
      // https://github.com/rstudio/distill/issues/466
      if (citeChild === undefined) return true

      if (citeChild.nodeName == "D-FOOTNOTE") {
        var fn = citeChild
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        // Could use CSS.escape too here, we insure backward compatibility in navigator
        return "<p>" + $('div[id="ref-' + ref + '"]').html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */

@import url('https://assets.ipums.org/_css/font-faces.css');

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #00263A;
  --header-color:    #00263A;
  --body-color:      #00263A;
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    cabrito_sans_norm_regular;
  --mono-font:       Menlo, Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-font:       cabrito_sans_norm_regular;
  --navbar-font:     cabrito_sans_norm_regular;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #00263A;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #00263A;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

h1{
  font-family: 'cabrito_sans_norm_regular';
  text-transform: uppercase;
  color: #00263A;
}

d-title h1{
  font-weight: 500;
}

d-article h1{
  font-size: 36px;
  line-height: 1.1em;
  font-weight: 100;
}

d-article h2{
    font-size: 30px;
    font-family: "cabrito_sans_cond_demi";
    text-transform: uppercase;
    color: #00263A;
    font-weight: 100;
}

d-article h3{
  font-size: 26px;
  font-family: 'cabrito_sans_cond_demi';
  color: #00263A;
  margin-top: 1.5rem;
  margin-bottom: 1em;
  font-weight: 100;
}

d-article h4{
  font-size: 24px;
  font-family: 'cabrito_sans_norm_regular';
  color: #00263A;
  text-transform: unset;
  margin-top: 1.5rem;
  margin-bottom: 1em;
  font-weight: 100;
}

d-article h5{
  font-size: 24px;
  font-family: 'cabrito_sans_cond_demi';
  color: #00263A;
  margin-top: 1.5rem;
  margin-bottom: 1em;
  font-weight: 100;
}

d-article li {
    margin-bottom: 0;
    margin-left: 1rem;
    padding-left: 0;
    color: #00263A;
}

d-article table {
    color: #00263A;
}
.d-contents nav > ul > li > a {
    font-weight: 100;
}

body{
  font-family: 'cabrito_subset';
}

b, strong {
  font-family: "cabrito_sans_cond_demi";
  font-weight: 100;
}

p>a {
    color: #98579B
}

li>a {
    color: #98579B;
}

.btn {
    font-family: "cabrito_subset";
    font-size: 16px;
    background-color: #F0E6F0;
    margin-bottom: 20px;
    border-width: 1px;
    padding-top: 6px;
    padding-bottom: 6px;
    cursor: pointer;
}

.distill-site-header .title {
    text-transform: uppercase;
    line-height: 38px;
    vertical-align: middle;
}

.distill-site-header .logo img{
  max-height: 50px; /* Makes logo bigger, default was 20px */
  vertical-align: middle;
  margin-bottom: 0;
}

.distill-site-header .nav-right {
    float: right;
    line-height: 38px;
    vertical-align: middle;
}

.distill-site-header .nav-left {
    display: inline-block;
    line-height: 38px;
    vertical-align: middle;
}

.algolia-autocomplete {
  line-height: 25px;
}

d-article iframe {
    border: 0;
    margin-bottom: 0;
    width: 100%;
}

d-article aside a {
  color: #98579B;
}

@media(max-width: 767px){
  aside{
    width: 50%;
    position: relative;
    left: 25%;
    padding-bottom: 20px;
  }
}

code {
  font-family: Menlo, Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

/* Prevent leaflet widgets from appearing above navbar */ 
.header {
  z-index: 1001;
}

d-article iframe {
  margin-bottom: 2em;
  margin-top: 2em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.11/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=UA-191039907-2"></script>
<script type="text/javascript" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-191039907-2');
</script>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Unmet need for family planning after internal migration","description":"Summary and source code from a recent article using data from Ethiopia.","authors":[{"author":"Matt Gunther","authorURL":"#","affiliation":"IPUMS PMA Senior Data Analyst","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-04-02T00:00:00.000-04:00","citationText":"Gunther, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://pma.ipums.org/pma/">
<img src="../../images/logo-white.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">Data Analysis Hub</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Posts</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Courses
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../introduction.html">Introduction to IPUMS PMA Data Analysis</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
R Tips
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../posts/2020-12-10-get-ipums-pma-data/index.html">Import IPUMS PMA Data into R</a>
<a href="../../posts/2020-12-10-get-r-and-packages/index.html">R, RStudio, and R Packages</a>
<a href="../../posts/2021-11-15-find-an-example/index.html">Find an Example</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Community
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../CONTRIBUTING.html">Contributing guide</a>
<a href="../../CODE_OF_CONDUCT.html">Code of conduct</a>
<a href="../../LICENSE.html">License</a>
<a href="https://github.com/ipums/pma-data-hub/">GitHub</a>
</div>
</div>
<a href="../../about.html">About</a>
<a href="../../index.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="https://twitter.com/ipumsGH">
<i class="fab fa-twitter" aria-hidden="true"></i>
</a>
<a href="https://github.com/ipums/pma-data-hub" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Unmet need for family planning after internal migration</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:Migration" class="dt-tag">Migration</a>
  <a href="../../index.html#category:PMA_Publications" class="dt-tag">PMA Publications</a>
  <a href="../../index.html#category:svyglm" class="dt-tag">svyglm</a>
  <a href="../../index.html#category:bootstraps" class="dt-tag">bootstraps</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>Summary and source code from a recent article using data from Ethiopia.</p></p>
</div>

<div class="d-byline">
  Matt Gunther  (IPUMS PMA Senior Data Analyst)
  
<br/>04/02/2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#motivation">Motivation</a></li>
<li><a href="#data">Data</a>
<ul>
<li><a href="#dependent-variable">Dependent variable</a></li>
<li><a href="#key-independent-variable">Key independent variable</a></li>
<li><a href="#covariates">Covariates</a></li>
<li><a href="#sub-sample">Sub-sample</a></li>
<li><a href="#reference-groups">Reference groups</a></li>
</ul></li>
<li><a href="#regression-model">Regression Model</a>
<ul>
<li><a href="#interpretation">Interpretation</a></li>
<li><a href="#predicted-probabilities">Predicted Probabilities</a></li>
</ul></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>When great new research gets published with PMA data on a topic we’re covering here on the Data Analysis Hub, we’ll cover the highlights and explore some source code in a <a href="../../index.html#category:PMA_Publications">PMA Publications</a> post.</p>
<aside>
Have a recent publication using PMA data that you’d like to feature in a <a href="../../index.html#category:PMA_Publications">PMA Publications</a> post? Please <a href="https://github.com/ipums/pma-data-hub/issues/new">let us know</a>!
</aside>
<p>As part of our new series on <a href="../../index.html#category:migration">women’s migration experiences</a> and their impact on family planning, let’s dig into a paper from University of Minnesota researchers <a href="https://orcid.org/0000-0003-1636-7061">Emily Groene</a> and <a href="https://pop.umn.edu/people/devon-kristiansen">Devon Kristiansen</a> <span class="citation" data-cites="Groene2021-ka">(<a href="#ref-Groene2021-ka" role="doc-biblioref">2021</a>)</span> published in the journal <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/psp.2376">Population, Space and Place</a>.</p>
<h1 id="motivation">Motivation</h1>
<p>As we’ll see throughout this series, migration can be associated with major changes in an individual’s fertility intentions and family planning access, and it can <em>either increase or decrease</em> the likelihood of experiencing unmet need for family planning under different circumstances. Groene &amp; Kristiansen focus their attention on the particular circumstances around rural-to-urban internal (within-country) migration, which is one of the prevailing modes of migration throughout the countries surveyed by PMA <span class="citation" data-cites="McAuliffe2017-sz">(<a href="#ref-McAuliffe2017-sz" role="doc-biblioref">McAuliffe and Ruhs 2017</a>)</span>.</p>
<p>Consider all of the potential changes a person might experience when moving from a rural to an urban area: Groene &amp; Kristiansen outline literature that suggests quite a few ways that these changes might impact fertility behavior. Some are likely to increase demand for family planning, for example:</p>
<ul>
<li>Increased availability and access to health services and long-acting contraceptives <span class="citation" data-cites="Skiles2015-hq">(<a href="#ref-Skiles2015-hq" role="doc-biblioref">Skiles et al. 2015</a>)</span></li>
<li>New opportunities for employment, education, and greater wealth that can delay or limit plans for additional births <span class="citation" data-cites="Schultz1994-lg">(<a href="#ref-Schultz1994-lg" role="doc-biblioref">Schultz 1994</a>)</span></li>
<li>Diminished incentives for larger family sizes tied to rural culture and livelihoods <span class="citation" data-cites="Abebe2007-hv">(<a href="#ref-Abebe2007-hv" role="doc-biblioref">Abebe 2007</a>)</span></li>
<li>Acculturation, or adoption of destination cultural roles and values <span class="citation" data-cites="Kohler2000-uc">(<a href="#ref-Kohler2000-uc" role="doc-biblioref">Kohler 2000</a>)</span></li>
</ul>
<p>On the other hand, several offsetting factors may push to maintain or even decrease demand for family planning:</p>
<ul>
<li>Spousal separation tied to seasonal migration for employment <span class="citation" data-cites="Sevoyan2013-am">(<a href="#ref-Sevoyan2013-am" role="doc-biblioref">Sevoyan and Agadjanian 2013</a>)</span></li>
<li>Family planning preferences established prior to migration <span class="citation" data-cites="Kulu2005-ho">(<a href="#ref-Kulu2005-ho" role="doc-biblioref">Kulu 2005</a>)</span></li>
<li>Selection into destinations where familiar cultural roles and values are prevalent <span class="citation" data-cites="Courgeau1989-py">(<a href="#ref-Courgeau1989-py" role="doc-biblioref">Courgeau 1989</a>)</span></li>
</ul>
<p>Even when we focus our analysis on rural-urban internal migrants, it’s very hard to predict how these and other factors might react to determine the family planning needs for any given person. From a policy perspective, where planning is needed to identify and address <strong>unmet need for family planning services</strong> on a larger scale, Groene &amp; Kristiansen offer important insights into the ways that migration experiences are tied to a particular place. Using female respondents from the Ethiopia 2017 and 2018 samples, they compare unmet need among rural-urban internal migrants to the unmet need experienced by non-migrants in both rural and urban settings. They find that migrants are <strong>less likely to experience unmet need</strong> compared to non-migrants, controlling for a number of demographic factors.</p>
<aside>
<b>Unmet need</b> is the difference between an individual’s reproductive intentions and contraceptive behavior.
</aside>
<p>In this post, we’ll show how to recreate their analysis using an IPUMS PMA data extract in R.</p>
<h1 id="data">Data</h1>
<p>The Ethiopia 2017 and 2018 samples were among the first PMA samples to include questions related to women’s <em>most recent</em> migration experience, and about the region where they were born. Their responses are included in variables listed in the <a href="https://pma.ipums.org/pma-action/variables/group/fem_mig">migration</a> variable group:</p>
<ul>
<li><code>LIVEINREGION</code> - How long living continuously in current region</li>
<li><code>LIVEINREGIONYRS</code> - Number of years continuously living in current region</li>
<li><code>LASTREGION</code> - Region/country of residence before current region</li>
<li><code>LASTUR</code> - Urban/rural status of residence before current region</li>
<li><code>BIRTHREGIONET</code> - Region of woman’s birth, Ethiopia</li>
<li><code>BIRTHUR</code> - Urban/rural status of region of woman’s birth</li>
<li><code>MIGMAINRSN</code> - The main reason why moved to current place of residence</li>
<li><code>MIGPREKID</code> - Gave birth before moved to current region</li>
<li><code>MIGPREKIDNUM</code> - Number of sons/daughters before moving to current region</li>
</ul>
<aside>
A 2013 sample of women from Kinshasa, DRC were also given questions related to their recent migration history, but these data have not been made available for public use. See Anglewicz et al. <span class="citation" data-cites="Anglewicz2017-jh">(<a href="#ref-Anglewicz2017-jh" role="doc-biblioref">2017</a>)</span>.
</aside>
<p>Groene &amp; Kristiansen use the variable <a href="https://pma.ipums.org/pma-action/variables/LIVEINREGION">LIVEINREGION</a> to determine whether a woman has always lived in the same place and, if not, they use <a href="https://pma.ipums.org/pma-action/variables/BIRTHUR">BIRTHUR</a> together with <a href="https://pma.ipums.org/pma-action/variables/URBAN">URBAN</a> to identify those who ultimately moved from a rural place to an urban place. We’ve created a data extract containing these and all of the other variables discussed below (female respondents only); we’ll start by loading it and the following packages in R:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.ipums.org'>ipumsr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidymodels.tidymodels.org'>tidymodels</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://r-survey.r-forge.r-project.org/survey/'>survey</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://gdfe.co/srvyr/'>srvyr</a></span><span class='op'>)</span>

<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'>ipumsr</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/ipumsr/man/read_ipums_micro.html'>read_ipums_micro</a></span><span class='op'>(</span>
  ddi <span class='op'>=</span> <span class='st'>"data/pma_00019.xml"</span>,
  data <span class='op'>=</span> <span class='st'>"data/pma_00019.dat.gz"</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<aside>
<p>If you’re a registered user at <a href="https://pma.ipums.org/pma/">pma.ipums.org</a>, you can recreate the authors’ data extract by selecting the variables mentioned in this post.</p>
See our guide for help <a href="../2020-12-10-get-ipums-pma-data/index.html">importing IPUMS data extracts into R</a>.
</aside>
<p>We’ll first label the various non-response values in this dataset with the value <code>NA</code> using <a href="http://tech.popdata.org/ipumsr/reference/lbl_na_if.html">ipumsr::lbl_na_if</a> applied to all variables with <a href="https://dplyr.tidyverse.org/reference/across.html">dplyr::across</a>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://tidyselect.r-lib.org/reference/everything.html'>everything</a></span><span class='op'>(</span><span class='op'>)</span>, <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/pkg/ipumsr/man/lbl_na_if.html'>lbl_na_if</a></span><span class='op'>(</span>
      <span class='va'>.x</span>,
      <span class='op'>~</span><span class='va'>.lbl</span> <span class='op'>%in%</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
        <span class='st'>"Don't know"</span>,
        <span class='st'>"No response or missing"</span>,
        <span class='st'>"NIU (not in universe)"</span>,
        <span class='st'>"NIU (not in universe) or missing"</span>
      <span class='op'>)</span>
    <span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Ethiopia samples are stratified by region (<a href="https://pma.ipums.org/pma-action/variables/GEOET">GEOET</a>) and urban status (<code>URBAN</code>), resulting in 21 sampling strata from which primary sampling units (<a href="https://pma.ipums.org/pma-action/variables/EAID">EAID</a>) are selected. The authors exclude women from any <a href="https://pma.ipums.org/pma-action/variables/STRATA">STRATA</a> where fewer than 200 women were sampled across both sample years:</p>
<aside>
PMA uses a multistage, stratified cluster sample design. For more information, see PMA’s <a href="https://pma.ipums.org/pma/resources/documentation/PMA2020_Survey_Sampling_Strategy_Memo.pdf">sample design memo</a>.
</aside>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> <span class='fu'>count</span><span class='op'>(</span><span class='va'>STRATA</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code># A tibble: 21 × 2
                                  STRATA     n
                               &lt;int+lbl&gt; &lt;int&gt;
 1 23101 [Addis Ababa - urban, Ethiopia]  1833
 2 23102 [Amhara - urban, Ethiopia]       1005
 3 23103 [Amhara - rural, Ethiopia]       1651
 4 23104 [Oromiya - urban, Ethiopia]      1216
 5 23105 [Oromiya - rural, Ethiopia]      2275
 6 23106 [Other, Ethiopia]                 839
 7 23107 [SNNP - urban, Ethiopia]         1904
 8 23108 [SNNP - rural, Ethiopia]         1241
 9 23109 [Tigray - urban, Ethiopia]       1455
10 23110 [Tigray - rural, Ethiopia]        810
11 23111 [Dire Dawa - urban, Ethiopia]      22
12 23112 [Dire Dawa - rural, Ethiopia]      29
13 23113 [Afar - urban, Ethiopia]           32
14 23114 [Afar - rural, Ethiopia]          218
15 23115 [Somali - urban, Ethiopia]         73
16 23116 [Somali - rural, Ethiopia]        123
17 23117 [Gambella - urban, Ethiopia]       34
18 23118 [Gambella - rural, Ethiopia]       23
19 23119 [Harari - urban, Ethiopia]         29
20 23120 [Harari - rural, Ethiopia]         26
21 23121 [BG - rural, Ethiopia]            172</code></pre>
</div>
<p>Note that this will drop women from <code>STRATA</code> numbered 23111-23113 and 23115-23121:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>STRATA</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>STRATA_N <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/groups.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='va'>STRATA_N</span> <span class='op'>&gt;</span> <span class='fl'>200</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="dependent-variable">Dependent variable</h2>
<p>Now, consider the dependent variable <a href="https://pma.ipums.org/pma-action/variables/UNMETYN">UNMETYN</a>, which is a constructed variable indicating whether each respondent currently has an unmet need for family planning. All respondents to the female questionnaire are included in the universe for <code>UNMETYN</code>, so women who are not able to become pregnant or are not sexually active are determined to have “no unmet need.”</p>
<aside>
<a href="https://pma.ipums.org/pma-action/variables/UNMETYN">UNMETYN</a> is a recoded binary indicator from <a href="https://pma.ipums.org/pma-action/variables/UNMETNEED">UNMETNEED</a>, which contains additional details on <em>types</em> of unmet need.
</aside>
<p>Within the combined sample of female respondents from both years, about 12% of women demonstrated unmet need for family planning:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarize</a></span><span class='op'>(</span>mean_UNMETYN <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>UNMETYN</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code># A tibble: 1 × 1
  mean_UNMETYN
         &lt;dbl&gt;
1        0.120</code></pre>
</div>
<p>We’ll use the <a href="http://r-survey.r-forge.r-project.org/survey/">survey</a> package - and its tidy companion <a href="https://cran.r-project.org/web/packages/srvyr/vignettes/srvyr-vs-survey.html">srvyr</a> - to specify PMA sample design in our population estimates. The function <code>srvyr::survey_mean</code> uses information about the survey design (given by <code>srvyr::as_survey_design</code>) to estimate that an average woman aged 15-49 in Ethiopia has about a 15% chance of experiencing unmet need for family planning, with a 95% confidence interval ranging between 13.5% and 16.7%:</p>
<aside>
<div class="layout-chunk" data-layout="l-body">
<a href="http://gdfe.co/srvyr/index.html">
<img src="../../images/hex/srvyr.png"/>
</a>
</div>
© Greg Freedman Ellis et al. (<a href="https://www.gnu.org/licenses/old-licenses/gpl-2.0.en.html">GPL 2</a> | <a href="https://www.gnu.org/licenses/gpl-3.0.html">GPL 3</a>)
</aside>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/as_survey_design.html'>as_survey_design</a></span><span class='op'>(</span>
    id <span class='op'>=</span> <span class='va'>EAID</span>,
    nest <span class='op'>=</span> <span class='cn'>T</span>,
    weight <span class='op'>=</span> <span class='va'>FQWEIGHT</span>,
    strata <span class='op'>=</span> <span class='va'>STRATA</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarize</a></span><span class='op'>(</span>pop_UNMETYN <span class='op'>=</span> <span class='fu'><a href='http://gdfe.co/srvyr/reference/survey_mean.html'>survey_mean</a></span><span class='op'>(</span><span class='va'>UNMETYN</span>, vartype <span class='op'>=</span> <span class='st'>"ci"</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 × 3
  pop_UNMETYN pop_UNMETYN_low pop_UNMETYN_upp
        &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;
1       0.151           0.135           0.167</code></pre>
</div>
<aside>
<a href="https://github.com/gergness/srvyr">srvyr</a> brings parts of <a href="https://github.com/tidyverse/dplyr/">dplyr</a> syntax to survey analysis, using the <a href="http://r-survey.r-forge.r-project.org/survey/">survey</a> package.
</aside>
<h2 id="key-independent-variable">Key independent variable</h2>
<p>In order to conduct a three-way comparison between rural-urban migrants, rural non-migrants, and urban non-migrants, the authors construct a variable we’ll call <code>MIGRANT_DIR</code>.</p>
<p>The first component of <code>MIGRANT_DIR</code> evaluates whether each woman ever migrated from her place of birth. Using <code>LIVEINREGION</code>, any woman reporting that she has “always” lived in her current region <em>is not</em> a migrant, and any woman who has lived in her current region for a number of “months or years” <em>is</em> a migrant (note: we cannot determine the migration history for all of the remaining cases, so they will be excluded from further analysis).</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> <span class='fu'>count</span><span class='op'>(</span><span class='va'>LIVEINREGION</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 4 × 2
             LIVEINREGION     n
                &lt;int+lbl&gt; &lt;int&gt;
1 10 [Always]             11777
2 20 [Currently visiting]   124
3 30 [Months or years]     2539
4 NA                          7</code></pre>
</div>
<p>Migrants who were born in a rural place <code>!BIRTHUR</code> and now live in an urban place <code>URBAN</code> meet the definition for rural-urban migrant. Non-migrants are classified by their current <code>URBAN</code> status only. All other women are implicitly given the value <code>NA</code> and then filtered out of the dataset.</p>
<aside>
We implicitly assign <code>NA</code> to any cases that aren’t specified by the logical statements inside <code>case_when()</code>.
</aside>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'>%&gt;%</span> 
   <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
     <span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>BIRTHUR</span>, <span class='va'>URBAN</span><span class='op'>)</span>, <span class='op'>~</span><span class='va'>.x</span> <span class='op'>%&gt;%</span> <span class='va'>zap_labels</span><span class='op'>)</span>,
     MIGRANT <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
       <span class='va'>LIVEINREGION</span> <span class='op'>==</span> <span class='fl'>30</span> <span class='op'>~</span> <span class='cn'>T</span>, 
       <span class='va'>LIVEINREGION</span> <span class='op'>==</span> <span class='fl'>10</span> <span class='op'>~</span> <span class='cn'>F</span>
     <span class='op'>)</span>,
     MIGRANT_DIR <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
       <span class='va'>MIGRANT</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='va'>BIRTHUR</span> <span class='op'>&amp;</span> <span class='va'>URBAN</span> <span class='op'>~</span> <span class='st'>"rural to urban"</span>,
       <span class='op'>!</span><span class='va'>MIGRANT</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='va'>URBAN</span> <span class='op'>~</span> <span class='st'>"nonmigrant - rural"</span>,
       <span class='op'>!</span><span class='va'>MIGRANT</span> <span class='op'>&amp;</span> <span class='va'>URBAN</span> <span class='op'>~</span> <span class='st'>"nonmigrant - urban"</span>
     <span class='op'>)</span> 
   <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>MIGRANT_DIR</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<aside>
Remember: <code>BIRTHUR</code> and <code>URBAN</code> are <em>labeled integers</em>. Our use of <code>zap_labels</code> allows R to ignore their assigned labels and, instead, treat them as <em>logicals</em> where <code>1 == TRUE</code> and <code>0 == FALSE</code>.
</aside>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> <span class='fu'>count</span><span class='op'>(</span><span class='va'>MIGRANT_DIR</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 3 × 2
  MIGRANT_DIR            n
  &lt;chr&gt;              &lt;int&gt;
1 nonmigrant - rural  6437
2 nonmigrant - urban  5340
3 rural to urban      1421</code></pre>
</div>
<p>You may notice that we’ve created <code>MIGRANT_DIR</code> as a string, or a <em>character</em> object. We’ll <a href="https://forcats.tidyverse.org/reference/as_factor.html">coerce</a> it as a <a href="https://r4ds.had.co.nz/factors.html">factor</a> later so we can easily use each of the three classifications in a logistic regression model.</p>
<h2 id="covariates">Covariates</h2>
<p>The authors control for a number of covariates in addition to <code>MIGRANT_DIR</code>. The following covariates are recoded versions of existing PMA variables:</p>
<ul>
<li><code>BIRTHS</code>: number of children ever born <a href="https://pma.ipums.org/pma-action/variables/CHEB">CHEB</a> (2017), or the woman’s total number of birth events <a href="https://pma.ipums.org/pma-action/variables/BIRTHEVENT">BIRTHEVENT</a> (2018, e.g. birth of twins is a single event)</li>
<li><code>PARTNERED</code>: recoded <a href="https://pma.ipums.org/pma-action/variables/MARSTAT">MARSTAT</a>, indicating if the woman is either currently married or living with a partner</li>
<li><code>RELGEN</code>: recoded <a href="https://pma.ipums.org/pma-action/variables/RELIGION">RELIGION</a> as “muslim,” “christian,” or “other”</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>BIRTHEVENT</span>, <span class='va'>CHEB</span><span class='op'>)</span>, <span class='op'>~</span><span class='va'>.x</span> <span class='op'>%&gt;%</span> <span class='va'>zap_labels</span><span class='op'>)</span>,
    BIRTHS <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
      <span class='va'>YEAR</span> <span class='op'>==</span> <span class='fl'>2018</span> <span class='op'>~</span> <span class='va'>BIRTHEVENT</span>, 
      <span class='cn'>T</span> <span class='op'>~</span> <span class='va'>CHEB</span>
    <span class='op'>)</span>,
    PARTNERED <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
      <span class='va'>MARSTAT</span> <span class='op'>%in%</span> <span class='fl'>21</span><span class='op'>:</span><span class='fl'>22</span> <span class='op'>~</span> <span class='cn'>T</span>, 
      <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>MARSTAT</span><span class='op'>)</span> <span class='op'>~</span> <span class='cn'>F</span>
    <span class='op'>)</span>,
    RELGEN <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
      <span class='va'>RELIGION</span> <span class='op'>==</span> <span class='fl'>100</span> <span class='op'>~</span> <span class='st'>"muslim"</span>,
      <span class='va'>RELIGION</span> <span class='op'>&gt;=</span> <span class='fl'>200</span> <span class='op'>&amp;</span> <span class='va'>RELIGION</span> <span class='op'>&lt;</span> <span class='fl'>300</span> <span class='op'>~</span> <span class='st'>"christian"</span>,
      <span class='cn'>T</span> <span class='op'>~</span> <span class='st'>"other"</span>
    <span class='op'>)</span>
  <span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The remaining covariates are used without further modification:</p>
<ul>
<li><a href="https://pma.ipums.org/pma-action/variables/LIVEINREGION">AGE</a>: the woman’s age (years)</li>
<li><a href="https://pma.ipums.org/pma-action/variables/WEALTHQ">WEALTHQ</a>: wealth quintile</li>
<li><a href="https://pma.ipums.org/pma-action/variables/EDUCATTGEN">EDUCATTGEN</a>: education level (general)</li>
<li><a href="https://pma.ipums.org/pma-action/variables/HCVISITY">HCVISITY</a>: whether the woman visited a health facility in the last 12 months</li>
<li><a href="https://pma.ipums.org/pma-action/variables/SUBNATIONAL">SUBNATIONAL</a>: subnational region</li>
<li><a href="https://pma.ipums.org/pma-action/variables/YEAR">YEAR</a>: survey year (2017 or 2018)</li>
</ul>
<h2 id="sub-sample">Sub-sample</h2>
<p>As discussed above, the authors exclude any female respondents from small <code>STRATA</code> (n &lt; 200) and those who are neither rural-urban migrants nor non-migrants. Additionally, they remove rural-urban migrants who moved to Ethiopia from another country. Women can indicate this information in two places: they may either list a foreign country in <code>LASTREGION</code> or indicate “abroad” as their region of birth in <a href="https://pma.ipums.org/pma-action/variables/BIRTHREGIONET">BIRTHREGIONET</a>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> <span class='fu'>count</span><span class='op'>(</span><span class='va'>LASTREGION</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 18 × 2
                   LASTREGION     n
                    &lt;int+lbl&gt; &lt;int&gt;
 1 101 [Tigray]                  50
 2 102 [Afar]                     7
 3 103 [Amhara]                 399
 4 104 [Oromia]                 360
 5 105 [Ethiopia Somali]          1
 6 106 [Benishangul Gumuz]        4
 7 107 [SNNPR]                  390
 8 108 [Gambella]                 4
 9 109 [Harari]                   7
10 110 [Addis Ababa]            116
11 111 [Dire Dawa]                7
12 202 [Saudi Arabia]            33
13 204 [Beirut]                   5
14 205 [United Arab Emirates]     9
15 206 [Sudan]                    5
16 210 [Lebanon]                  1
17 300 [Other]                   23
18  NA                        11777</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> <span class='fu'>count</span><span class='op'>(</span><span class='va'>BIRTHREGIONET</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 12 × 2
                                               BIRTHREGIONET     n
                                                   &lt;int+lbl&gt; &lt;int&gt;
 1  1 [Tigray Region]                                         2110
 2  2 [Afar Region]                                            430
 3  3 [Amhara Region]                                         2911
 4  4 [Oromia Region]                                         3472
 5  5 [Somali Region]                                          166
 6  6 [Benishangul-Gumuz Region]                               148
 7  7 [Southern Nations, Nationalities, and Peoples&#39; Region]  3057
 8  8 [Gambella Region]                                         26
 9  9 [Harari Region]                                           35
10 10 [Addis Ababa (city)]                                     814
11 11 [Dire Dawa (city)]                                        27
12 12 [Abroad]                                                   2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    EXTERNAL <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
      <span class='va'>LASTREGION</span> <span class='op'>%in%</span> <span class='fl'>200</span><span class='op'>:</span><span class='fl'>900</span> <span class='op'>|</span> <span class='va'>BIRTHREGIONET</span> <span class='op'>==</span> <span class='fl'>12</span> <span class='op'>~</span> <span class='cn'>T</span>,
      <span class='cn'>T</span> <span class='op'>~</span> <span class='cn'>F</span>
    <span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='va'>EXTERNAL</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>The authors also exclude women whose <code>PARTNERED</code> status (i.e. sexual activity) cannot be determined, and women who indicate that they are either “infertile” in <a href="https://pma.ipums.org/pma-action/variables/FERTPREF">FERTPREF</a> or “menopausal / hysterectomy” in <a href="https://pma.ipums.org/pma-action/variables/TIMEMENSTRUATE">TIMEMENSTRUATE</a>. Women who are not at risk of pregnancy for these reasons cannot have unmet need, so they are removed from the sample.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> <span class='fu'>count</span><span class='op'>(</span><span class='va'>PARTNERED</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 3 × 2
  PARTNERED     n
  &lt;lgl&gt;     &lt;int&gt;
1 FALSE      5513
2 TRUE       7606
3 NA            2</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> <span class='fu'>count</span><span class='op'>(</span><span class='va'>FERTPREF</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 4 × 2
                 FERTPREF     n
                &lt;int+lbl&gt; &lt;int&gt;
1  1 [Have another child]  8983
2  2 [No more children]    2702
3  3 [Infertile]            225
4 NA                       1211</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> <span class='fu'>count</span><span class='op'>(</span><span class='va'>TIMEMENSTRUATE</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 8 × 2
                TIMEMENSTRUATE     n
                     &lt;int+lbl&gt; &lt;int&gt;
1  1 [Days]                     3113
2  2 [Weeks]                    4111
3  3 [Months]                   2955
4  4 [Years]                    1276
5  5 [Menopausal/hysterectomy]    85
6  6 [Before last birth]        1231
7  7 [Never menstruated]         317
8 NA                              33</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    INFERTILE <span class='op'>=</span> <span class='fu'>case_when</span><span class='op'>(</span>
      <span class='va'>FERTPREF</span> <span class='op'>==</span> <span class='fl'>3</span> <span class='op'>|</span> <span class='va'>TIMEMENSTRUATE</span> <span class='op'>==</span> <span class='fl'>5</span> <span class='op'>~</span> <span class='cn'>T</span>,
      <span class='cn'>T</span> <span class='op'>~</span> <span class='cn'>F</span>
    <span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>PARTNERED</span><span class='op'>)</span>, <span class='op'>!</span><span class='va'>INFERTILE</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Lastly, they exclude women with missing values on any of the remaining covariates.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span>
    <span class='op'>!</span><span class='fu'>if_any</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>UNMETYN</span>, <span class='va'>EDUCATTGEN</span>, <span class='va'>HCVISITY</span>, <span class='va'>BIRTHS</span>, <span class='va'>MCP</span><span class='op'>)</span>, <span class='va'>is.na</span><span class='op'>)</span>,
  <span class='op'>)</span>
</code></pre>
</div>
</div>
<p>From 15,010 female respondents included in the original extract, this sub-sampling procedure leaves us with 12,630 remaing cases.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarize</a></span><span class='op'>(</span>n <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>n</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 × 1
      n
  &lt;int&gt;
1 12630</code></pre>
</div>
<h2 id="reference-groups">Reference groups</h2>
<p>As a final processing step, we’ll coerce each of our categorical variables (including <code>MIGRANT_DIR</code>) as factors. All but one of these is a <em>labelled integer</em> object where we’ll use the response with the lowest value as a reference group; because we created <code>MIGRANT_DIR</code> as a <em>character</em> object, we’ll specify its reference group manually:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span>
      <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
        <span class='va'>MIGRANT_DIR</span>, 
        <span class='va'>RELGEN</span>, 
        <span class='va'>WEALTHQ</span>, 
        <span class='va'>EDUCATTGEN</span>, 
        <span class='va'>HCVISITY</span>, 
        <span class='va'>SUBNATIONAL</span>, 
        <span class='va'>PARTNERED</span>,
        <span class='va'>YEAR</span>
      <span class='op'>)</span>, 
      <span class='op'>~</span><span class='fu'><a href='https://forcats.tidyverse.org/reference/as_factor.html'>as_factor</a></span><span class='op'>(</span><span class='va'>.</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/droplevels.html'>droplevels</a></span><span class='op'>(</span><span class='op'>)</span>
    <span class='op'>)</span>,
    MIGRANT_DIR <span class='op'>=</span> <span class='fu'>fct_relevel</span><span class='op'>(</span><span class='va'>MIGRANT_DIR</span>, <span class='st'>"nonmigrant - urban"</span><span class='op'>)</span>
  <span class='op'>)</span>
</code></pre>
</div>
</div>
<h1 id="regression-model">Regression Model</h1>
<p>Finally, we’re ready to build a regression model for <code>UNMETYN</code> using <code>MIGRANT_DIR</code> and the covariates discussed above!</p>
<p>Recall that the function <code>srvyr::survey_mean</code> estimated that 15.1% of <em>all</em> women aged 15-49 in Ethiopia experience unmet need for family planning. This estimate used all of the women in our original sample prior to the sub-sampling procedure we just discussed. Now that we’ve created a sub-sample from the original dataset, let’s see how the population estimate has changed:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/as_survey_design.html'>as_survey_design</a></span><span class='op'>(</span>
    id <span class='op'>=</span> <span class='va'>EAID</span>,
    nest <span class='op'>=</span> <span class='cn'>T</span>,
    weight <span class='op'>=</span> <span class='va'>FQWEIGHT</span>,
    strata <span class='op'>=</span> <span class='va'>STRATA</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarize</a></span><span class='op'>(</span>pop_UNMETYN <span class='op'>=</span> <span class='fu'><a href='http://gdfe.co/srvyr/reference/survey_mean.html'>survey_mean</a></span><span class='op'>(</span><span class='va'>UNMETYN</span>, vartype <span class='op'>=</span> <span class='st'>"ci"</span>, na.rm <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 1 × 3
  pop_UNMETYN pop_UNMETYN_low pop_UNMETYN_upp
        &lt;dbl&gt;           &lt;dbl&gt;           &lt;dbl&gt;
1       0.157           0.140           0.174</code></pre>
</div>
<p>Now that we’ve removed some cases (notably, all women who are infertile), the estimated population mean is close, but somewhat higher at 15.7%.</p>
<p>Groene &amp; Kristiansen build a multilevel <em>logistic regression</em> model for <code>UNMETYN</code> that breaks down this full-population estimate for each of the sub-groups represented by our independent variables. We’ll report the exponentiated coefficient estimates for each variable, which means that we’ll need to interpret each estimate as a <em>change in the odds</em> that a woman will experience <code>UNMETYN</code> <em>relative to</em> a woman in a reference group.</p>
<p>We’ll build the authors’ model <code>m1</code> using the function <a href="https://rdrr.io/cran/survey/man/svyglm.html">survey::svyglm</a>, which - like <code>survey_mean</code> - uses information about the sample design provided by <code>as_survey_design</code> to generate cluster-robust standard error estimates:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m1</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/as_survey_design.html'>as_survey_design</a></span><span class='op'>(</span>
    id <span class='op'>=</span> <span class='va'>EAID</span>,
    nest <span class='op'>=</span> <span class='cn'>T</span>,
    weight <span class='op'>=</span> <span class='va'>FQWEIGHT</span>,
    strata <span class='op'>=</span> <span class='va'>STRATA</span>
  <span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='https://rdrr.io/pkg/survey/man/svyglm.html'>svyglm</a></span><span class='op'>(</span>
    <span class='va'>UNMETYN</span> <span class='op'>~</span>  
      <span class='va'>AGE</span> <span class='op'>+</span> 
      <span class='va'>MIGRANT_DIR</span> <span class='op'>+</span>
      <span class='va'>RELGEN</span> <span class='op'>+</span> 
      <span class='va'>WEALTHQ</span> <span class='op'>+</span>
      <span class='va'>EDUCATTGEN</span> <span class='op'>+</span> 
      <span class='va'>BIRTHS</span> <span class='op'>+</span> 
      <span class='va'>HCVISITY</span> <span class='op'>+</span> 
      <span class='va'>SUBNATIONAL</span> <span class='op'>+</span>
      <span class='va'>PARTNERED</span> <span class='op'>+</span> 
      <span class='va'>YEAR</span>,
    design <span class='op'>=</span> <span class='va'>.</span>,
    family <span class='op'>=</span> <span class='st'>"quasibinomial"</span>,
  <span class='op'>)</span> 
</code></pre>
</div>
</div>
<aside>
<p>We tell <code>svyglm</code> to fit a logistic regression model with <code>family = "quasibinomial"</code>.</p>
Why “quasi” binomial? A simple binomial distribution yields the same point estimates and standard errors, but generates a warning because our use of sample weights produces a non-integer count of women with unmet need.
</aside>
<p>To simplify the output a bit, we’ll show a <code>tidy</code> table with just the term, point estimate, the 95% confidence interval, and the p-value (each rounded to two decimal places):</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>m1</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>tidy</span><span class='op'>(</span>exp <span class='op'>=</span> <span class='cn'>T</span>, conf.int <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>select</a></span><span class='op'>(</span><span class='va'>term</span>, <span class='va'>estimate</span>, <span class='va'>conf.low</span>, <span class='va'>conf.high</span>, <span class='va'>p.value</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span><span class='fu'>where</span><span class='op'>(</span><span class='va'>is.numeric</span><span class='op'>)</span>, <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>.x</span>, <span class='fl'>2</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code># A tibble: 27 × 5
   term                            estimate conf.low conf.high p.value
   &lt;chr&gt;                              &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 (Intercept)                         0.13     0.06      0.27    0   
 2 AGE                                 0.96     0.94      0.97    0   
 3 MIGRANT_DIRnonmigrant - rural       1.15     0.84      1.55    0.38
 4 MIGRANT_DIRrural to urban           0.75     0.59      0.96    0.02
 5 RELGENother                         0.88     0.58      1.34    0.54
 6 RELGENchristian                     0.59     0.48      0.72    0   
 7 WEALTHQLower quintile               0.99     0.79      1.25    0.96
 8 WEALTHQMiddle quintile              1.06     0.84      1.33    0.63
 9 WEALTHQHigher quintile              0.82     0.64      1.05    0.11
10 WEALTHQHighest quintile             0.84     0.56      1.27    0.42
11 EDUCATTGENPrimary/Middle school     1.05     0.87      1.26    0.59
12 EDUCATTGENSecondary/post-prima…     0.76     0.55      1.05    0.1 
13 EDUCATTGENTertiary/post-second…     1        0.68      1.49    0.98
14 BIRTHS                              1.24     1.18      1.31    0   
15 HCVISITYYes                         0.85     0.71      1.01    0.06
16 SUBNATIONALAfar, Ethiopia           0.23     0.12      0.44    0   
17 SUBNATIONALAmhara, Ethiopia         0.55     0.44      0.69    0   
18 SUBNATIONALOromiya, Ethiopia        0.91     0.73      1.14    0.41
19 SUBNATIONALSomali, Ethiopia         0.74     0.33      1.7     0.48
20 SUBNATIONALBenishangul-Gumuz, …     0.55     0.28      1.08    0.08
21 SUBNATIONALSNNP, Ethiopia           0.9      0.68      1.2     0.48
22 SUBNATIONALGambella, Ethiopia       0.86     0.15      4.9     0.86
23 SUBNATIONALHarari, Ethiopia         2.06     1.69      2.52    0   
24 SUBNATIONALAddis Ababa, Ethiop…     0.98     0.69      1.4     0.93
25 SUBNATIONALDire Dawa, Ethiopia      0.77     0.47      1.27    0.3 
26 PARTNEREDTRUE                       6.69     4.75      9.43    0   
27 YEAR2018                            0.88     0.74      1.05    0.15</code></pre>
</div>
<h2 id="interpretation">Interpretation</h2>
<p>Controlling for all of the covariates we’ve discussed, the authors find that <strong>rural-urban internal migrants are less likely than both urban and rural non-migrants to experience unmet need for family planning!</strong></p>
<p>How do we identify this finding in the model output? Notice that the estimated odds of experiencing <code>UNMETYN</code> for <code>rural to urban</code> migrants is 0.75, and that the associated 95% confidence interval ranges from 0.59 to 0.95: this represents the migrants’ odds <em>compared to urban non-migrants</em>. If the 95% confidence interval included the value 1.0, we would say that there’s more than a 5% chance that the migrants’ odds could be equal to the odds experienced by urban non-migrants. Because it does <em>not</em> include 1.0, we instead say that there’s a statistically significant difference between the two groups (at the 5% confidence threshold).</p>
<p>Because the authors selected urban non-migrants as a reference group, our model output shows the relationship between rural non-migrants and rural-urban migrants a bit less clearly. Although the point estimate for <code>rural to urban</code> migrants (0.75) is lower than the point estimate for <code>nonmigrant - rural</code> (1.15), their respective confidence intervals overlap. In order to see that they actually <em>are</em> statistically different, we’d need to run the model again with a different reference group.</p>
<h2 id="predicted-probabilities">Predicted Probabilities</h2>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>While the output from our logistic regression model helps show the <em>relative difference</em> between groups, we’re not yet able to predict the <em>absolute</em> risk of <code>UNMETYN</code> for each group. Recall that, before building our model, we calculated that the average unmet need for all women in Ethiopia (excluding external migrants, infertile women, etc) was about 15.7%. We’ll now estimate the average unmet need experienced by all women in Ethiopia sorted into the three groups represented by <code>MIGRANT_DIR</code>.</p>
<p>The <code>predict</code> function allows us to make a prediction about each woman’s likelihood of experiencing unmet need according to the model <code>m1</code>. When we tell <code>predict</code> to return <code>type = "response"</code>, it gives us the predicted probability that each woman should have <code>UNMETYN</code>.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tibble</span><span class='op'>(</span>predicted <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>m1</span>, type <span class='op'>=</span> <span class='st'>"response"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 12,630 × 1
   predicted  
   &lt;svystat&gt;  
 1 0.072659141
 2 0.338704987
 3 0.033291206
 4 0.376765517
 5 0.025819303
 6 0.528723102
 7 0.009790659
 8 0.088323159
 9 0.044348246
10 0.027093896
# … with 12,620 more rows</code></pre>
</div>
<p>If we wanted to compare each individual’s <em>predicted</em> probability to the value they actually <em>do</em> have for <code>UNMETYN</code>, we could attach our prediction back to our dataset. Remember that the original <code>UNMETYN</code> variable is binary, whereas the predictions are continuous probabilities that range from 0 to 1. Here, we hope to see that women whose predicted probability exceeds 0.50 have <code>UNMETYN == 1</code>, while those whose predicted probability is less than 0.50 have <code>UNMETYN == 0</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tibble</span><span class='op'>(</span>predicted <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span><span class='va'>m1</span>, type <span class='op'>=</span> <span class='st'>"response"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>bind_cols</span><span class='op'>(</span><span class='va'>dat</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>select</a></span><span class='op'>(</span><span class='va'>predicted</span>, <span class='va'>UNMETYN</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code># A tibble: 12,630 × 2
   predicted             UNMETYN
   &lt;svystat&gt;           &lt;int+lbl&gt;
 1 0.072659141 0 [No unmet need]
 2 0.338704987 0 [No unmet need]
 3 0.033291206 0 [No unmet need]
 4 0.376765517 0 [No unmet need]
 5 0.025819303 0 [No unmet need]
 6 0.528723102 1 [Unmet need]   
 7 0.009790659 0 [No unmet need]
 8 0.088323159 0 [No unmet need]
 9 0.044348246 0 [No unmet need]
10 0.027093896 0 [No unmet need]
# … with 12,620 more rows</code></pre>
</div>
<p>We can also use <code>predict</code> to calculate predicted probabilities for hypothetical samples. For instance, the authors provide the predicted probabilities for a hypothetical sample of women that is completely identical to the real sample, except that they all share the same value for <code>MIGRANT_DIR</code> (all other variables are kept at their originial values). The mean predicted probability derived from this kind of hypothetical sample is known as a <strong>predictive margin</strong>.</p>
<p>While the point estimates for each group in <code>MIGRANT_DIR</code> are easy to calculate with <code>predict</code>, the confidence intervals for those estimates are a bit harder to obtain. Here, we’ll use <a href="https://rsample.tidymodels.org/reference/bootstraps.html">rsample::bootstraps</a> to generate 100 replicates of our sample. This will allow us to rebuild our model 100 times:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span><span class='op'>(</span><span class='fl'>1</span><span class='op'>)</span> <span class='co'># This ensures reproducible bootstrap sampling</span>

<span class='va'>boots_dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>rsample</span><span class='fu'>::</span><span class='fu'><a href='https://rsample.tidymodels.org/reference/bootstraps.html'>bootstraps</a></span><span class='op'>(</span><span class='fl'>100</span>, <span class='va'>EAID</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>transmute</a></span><span class='op'>(</span>
    id <span class='op'>=</span> <span class='fu'>parse_number</span><span class='op'>(</span><span class='va'>id</span><span class='op'>)</span>,
    splits <span class='op'>=</span> <span class='fu'>map</span><span class='op'>(</span><span class='va'>splits</span>, <span class='va'>as_tibble</span><span class='op'>)</span>,
    model <span class='op'>=</span> <span class='fu'>map</span><span class='op'>(</span><span class='va'>splits</span>, <span class='op'>~</span><span class='op'>{</span>
      <span class='va'>.x</span> <span class='op'>%&gt;%</span> 
        <span class='fu'><a href='http://gdfe.co/srvyr/reference/as_survey_design.html'>as_survey_design</a></span><span class='op'>(</span>
          id <span class='op'>=</span> <span class='va'>EAID</span>,
          nest <span class='op'>=</span> <span class='cn'>T</span>,
          weight <span class='op'>=</span> <span class='va'>FQWEIGHT</span>,
          strata <span class='op'>=</span> <span class='va'>STRATA</span>
        <span class='op'>)</span> <span class='op'>%&gt;%</span> 
        <span class='fu'><a href='https://rdrr.io/pkg/survey/man/svyglm.html'>svyglm</a></span><span class='op'>(</span>
          <span class='va'>UNMETYN</span> <span class='op'>~</span>  
            <span class='va'>AGE</span> <span class='op'>+</span> 
            <span class='va'>MIGRANT_DIR</span> <span class='op'>+</span>
            <span class='va'>RELGEN</span> <span class='op'>+</span> 
            <span class='va'>WEALTHQ</span> <span class='op'>+</span>
            <span class='va'>EDUCATTGEN</span> <span class='op'>+</span> 
            <span class='va'>BIRTHS</span> <span class='op'>+</span> 
            <span class='va'>HCVISITY</span> <span class='op'>+</span> 
            <span class='va'>SUBNATIONAL</span> <span class='op'>+</span>
            <span class='va'>PARTNERED</span> <span class='op'>+</span> 
            <span class='va'>YEAR</span>,
          design <span class='op'>=</span> <span class='va'>.</span>,
          family <span class='op'>=</span> <span class='st'>"quasibinomial"</span>,
        <span class='op'>)</span> 
    <span class='op'>}</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='va'>boots_dat</span>
</code></pre>
</div>
<pre><code># A tibble: 100 × 3
      id splits                 model   
   &lt;dbl&gt; &lt;list&gt;                 &lt;list&gt;  
 1     1 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt;
 2     2 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt;
 3     3 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt;
 4     4 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt;
 5     5 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt;
 6     6 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt;
 7     7 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt;
 8     8 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt;
 9     9 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt;
10    10 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt;
# … with 90 more rows</code></pre>
</div>
<aside>
<div class="layout-chunk" data-layout="l-body">
<a href="https://rsample.tidymodels.org">
<img src="../../images/hex/rsample.png"/>
</a>
</div>
<p>© 2018 RStudio (<a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0 1.0</a>)</p>
<a href="https://rsample.tidymodels.org/reference/bootstraps.html">rsample</a> is included with <code>library(tidymodels)</code>.
</aside>
<p>Notice that each row of <code>boots_dat</code> contains a completely resampled version of <code>dat</code> contained in each row of the column <code>splits</code>. The column <code>model</code> contains the output from a model that’s uniquely fitted to the resampled data in <code>splits</code>.</p>
<p>Next, we’ll use <code>predict</code> separately for each row in <code>boots_dat</code>. Because we generate three new rows each time - one prediction for each group in <code>MIGRANT_DIR</code> - the resulting data frame has 300 rows.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>boots_dat</span> <span class='op'>&lt;-</span> <span class='va'>boots_dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>rowwise</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>nested_predictions <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='fu'>map_df</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/levels.html'>levels</a></span><span class='op'>(</span><span class='va'>dat</span><span class='op'>$</span><span class='va'>MIGRANT_DIR</span><span class='op'>)</span>, <span class='op'>~</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/stats/predict.html'>predict</a></span><span class='op'>(</span>
      <span class='va'>model</span>, 
      type <span class='op'>=</span> <span class='st'>"response"</span>, 
      newdata <span class='op'>=</span> <span class='va'>splits</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>MIGRANT_DIR <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>tibble</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'>bind_cols</span><span class='op'>(</span><span class='va'>splits</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/as_survey_design.html'>as_survey_design</a></span><span class='op'>(</span>
        id <span class='op'>=</span> <span class='va'>EAID</span>,
        nest <span class='op'>=</span> <span class='cn'>T</span>,
        weight <span class='op'>=</span> <span class='va'>FQWEIGHT</span>,
        strata <span class='op'>=</span> <span class='va'>STRATA</span>
      <span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarise</a></span><span class='op'>(</span>predicted <span class='op'>=</span> <span class='fu'><a href='http://gdfe.co/srvyr/reference/survey_mean.html'>survey_mean</a></span><span class='op'>(</span><span class='va'>.</span>, vartype <span class='op'>=</span> <span class='st'>"ci"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>MIGRANT_DIR <span class='op'>=</span> <span class='va'>.x</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>select</a></span><span class='op'>(</span><span class='va'>MIGRANT_DIR</span>, <span class='va'>predicted</span><span class='op'>)</span> 
  <span class='op'>}</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>unnest</span><span class='op'>(</span><span class='va'>nested_predictions</span><span class='op'>)</span> 

<span class='va'>boots_dat</span>
</code></pre>
</div>
<pre><code># A tibble: 300 × 5
      id splits                 model    MIGRANT_DIR        predicted
   &lt;dbl&gt; &lt;list&gt;                 &lt;list&gt;   &lt;chr&gt;                  &lt;dbl&gt;
 1     1 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt; nonmigrant - urban    0.151 
 2     1 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt; nonmigrant - rural    0.163 
 3     1 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt; rural to urban        0.112 
 4     2 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt; nonmigrant - urban    0.149 
 5     2 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt; nonmigrant - rural    0.155 
 6     2 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt; rural to urban        0.0840
 7     3 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt; nonmigrant - urban    0.142 
 8     3 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt; nonmigrant - rural    0.155 
 9     3 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt; rural to urban        0.133 
10     4 &lt;tibble [12,630 × 38]&gt; &lt;svyglm&gt; nonmigrant - urban    0.133 
# … with 290 more rows</code></pre>
</div>
<p>Finally, we’ll calculate:</p>
<ul>
<li>the <strong>predicted probability</strong> for each group from the mean of 100 bootstrap predictions</li>
<li>the <strong>standard error</strong> of each group’s predicted probability from the standard deviation of 100 bootstrap predictions</li>
<li>the <strong>95% confidence interval</strong> from the product of each group’s standard error and <code>qnrom(0.975)</code></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>group_predictions</span> <span class='op'>&lt;-</span> <span class='va'>boots_dat</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>MIGRANT_DIR</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarise</a></span><span class='op'>(</span>
    mean <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>predicted</span><span class='op'>)</span>,
    se <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/sd.html'>sd</a></span><span class='op'>(</span><span class='va'>predicted</span><span class='op'>)</span>,
    lower <span class='op'>=</span> <span class='va'>mean</span> <span class='op'>-</span> <span class='va'>se</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='fl'>0.975</span><span class='op'>)</span>,
    upper <span class='op'>=</span> <span class='va'>mean</span> <span class='op'>+</span> <span class='va'>se</span><span class='op'>*</span><span class='fu'><a href='https://rdrr.io/r/stats/Normal.html'>qnorm</a></span><span class='op'>(</span><span class='fl'>0.975</span><span class='op'>)</span>
  <span class='op'>)</span>

<span class='va'>group_predictions</span>
</code></pre>
</div>
<pre><code># A tibble: 3 × 5
  MIGRANT_DIR         mean      se  lower upper
  &lt;chr&gt;              &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1 nonmigrant - rural 0.161 0.00568 0.149  0.172
2 nonmigrant - urban 0.143 0.0125  0.119  0.168
3 rural to urban     0.117 0.0171  0.0831 0.150</code></pre>
</div>
<p>And here are those intervals plotted with <code>geom_errorbarh</code> and <code>geom_point</code>:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>group_predictions</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_errorbarh</span><span class='op'>(</span>
    color <span class='op'>=</span> <span class='st'>"#A2269C"</span>, 
    <span class='fu'>aes</span><span class='op'>(</span>height <span class='op'>=</span> <span class='fl'>.2</span>, xmin <span class='op'>=</span> <span class='va'>lower</span>, xmax <span class='op'>=</span> <span class='va'>upper</span>, y <span class='op'>=</span> <span class='va'>MIGRANT_DIR</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>geom_point</span><span class='op'>(</span>
    color <span class='op'>=</span> <span class='st'>"#A2269C"</span>, 
    <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>mean</span>, y <span class='op'>=</span> <span class='va'>MIGRANT_DIR</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_text</span><span class='op'>(</span>
    nudge_y <span class='op'>=</span> <span class='fl'>0.2</span>,
    <span class='fu'>aes</span><span class='op'>(</span>label <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>mean</span>, <span class='fl'>3</span><span class='op'>)</span>, x <span class='op'>=</span> <span class='va'>mean</span>, y <span class='op'>=</span> <span class='va'>MIGRANT_DIR</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>scale_x_continuous</span><span class='op'>(</span>breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span><span class='op'>(</span><span class='fl'>.08</span>, <span class='fl'>.18</span>, by <span class='op'>=</span> <span class='fl'>.02</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>labs</span><span class='op'>(</span>
    subtitle <span class='op'>=</span> <span class='st'>"95% Confidence Interval"</span>,
    title <span class='op'>=</span> <span class='st'>"Predicted Probability of Unmet Need for Family Planning"</span>,
    y <span class='op'>=</span> <span class='st'>""</span>,
    x <span class='op'>=</span> <span class='st'>""</span>
  <span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>theme</span><span class='op'>(</span>
    plot.title <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.5</span>, size <span class='op'>=</span> <span class='fl'>14</span><span class='op'>)</span>,
    plot.subtitle <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0.5</span>, size <span class='op'>=</span> <span class='fl'>10</span><span class='op'>)</span>
  <span class='op'>)</span> 
</code></pre>
</div>
<p><img src="et-internal-migration_files/figure-html5/unnamed-chunk-27-1.png" width="624" /></p>
</div>
<p>As you can see, the confidence intervals for each group in <code>MIGRANT_DIR</code> overlap quite a bit. However, the probability that a rural-urban internal migrant will experience unmet need for family planning seems to be generally lower than the other groups: we show a point-estimate of just 11.7% for migrants compared to 14.3% and 16.1% respectively for urban and rural non-migrants.</p>
<p>To learn more about the conceptual reasons why rural-urban internal migrants in Ethiopia might experience less unmet need for family planning compared to non-migrants, be sure to checkout out Groene &amp; Kristiansen’s full article published at <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/psp.2376">Populations, Space and Place</a>! And, for more information about migration data available in other PMA samples, stay tuned for upcoming posts in <a href="../../index.html#category:Migration">this series</a>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-Abebe2007-hv" class="csl-entry" role="doc-biblioentry">
Abebe, Tatek. 2007. <span>“Changing Livelihoods, Changing Childhoods: Patterns of Children’s Work in Rural Southern Ethiopia.”</span> <em>Children’s Geographies</em> 5 (1-2): 77–93. <a href="https://doi.org/10.1080/14733280601108205">https://doi.org/10.1080/14733280601108205</a>.
</div>
<div id="ref-Anglewicz2017-jh" class="csl-entry" role="doc-biblioentry">
Anglewicz, Philip, Jamaica Corker, and Patrick Kayembe. 2017. <span>“The Fertility of Internal Migrants to Kinshasa.”</span> <em>Genus</em> 73 (1): 4. <a href="http://dx.doi.org/10.1186/s41118-017-0020-8">http://dx.doi.org/10.1186/s41118-017-0020-8</a>.
</div>
<div id="ref-Courgeau1989-py" class="csl-entry" role="doc-biblioentry">
Courgeau, D. 1989. <span>“Family Formation and Urbanization.”</span> <em>Population. English Selection</em> 44 (1): 123–46. <a href="https://www.ncbi.nlm.nih.gov/pubmed/12157901">https://www.ncbi.nlm.nih.gov/pubmed/12157901</a>.
</div>
<div id="ref-Groene2021-ka" class="csl-entry" role="doc-biblioentry">
Groene, Emily A, and Devon Kristiansen. 2021. <span>“Unmet Need for Family Planning After Internal Migration: Analysis of Ethiopia 2017–2018 <span>PMA</span> Survey Data.”</span> <em>Population, Space and Place</em> 27 (1). <a href="https://onlinelibrary.wiley.com/doi/10.1002/psp.2376">https://onlinelibrary.wiley.com/doi/10.1002/psp.2376</a>.
</div>
<div id="ref-Kohler2000-uc" class="csl-entry" role="doc-biblioentry">
Kohler, Hans-Peter. 2000. <span>“Social Interactions and Fluctuations in Birth Rates.”</span> <em>Population Studies</em> 54 (2): 223–37. <a href="https://doi.org/10.1080/713779084">https://doi.org/10.1080/713779084</a>.
</div>
<div id="ref-Kulu2005-ho" class="csl-entry" role="doc-biblioentry">
Kulu, Hill. 2005. <span>“Migration and Fertility: Competing Hypotheses Re-Examined.”</span> <em>European Journal of Population/Revue Europ<span>é</span>enne de D<span>é</span>mographie</em> 21 (1): 51–87. <a href="https://idp.springer.com/authorize/casa?redirect_uri=https://link.springer.com/content/pdf/10.1007/s10680-005-3581-8.pdf&amp;casa_token=ofnVP7_3oy4AAAAA:nOmsfJTITgKjtiNcXj6u9GsVD9yHCkWsqmAtwTs6aG3vrQaL9DlhaOwcxFQMYweYNSt1mAtGNNonsZ-9">https://idp.springer.com/authorize/casa?redirect_uri=https://link.springer.com/content/pdf/10.1007/s10680-005-3581-8.pdf&amp;casa_token=ofnVP7_3oy4AAAAA:nOmsfJTITgKjtiNcXj6u9GsVD9yHCkWsqmAtwTs6aG3vrQaL9DlhaOwcxFQMYweYNSt1mAtGNNonsZ-9</a>.
</div>
<div id="ref-McAuliffe2017-sz" class="csl-entry" role="doc-biblioentry">
McAuliffe, Marie, and Martin Ruhs. 2017. <span>“World Migration Report 2018.”</span> <em>International Office of Migration, Geneva</em>. <a href="https://publications.iom.int/fr/system/files/pdf/wmr_2018_en_chapter7.pdf">https://publications.iom.int/fr/system/files/pdf/wmr_2018_en_chapter7.pdf</a>.
</div>
<div id="ref-Schultz1994-lg" class="csl-entry" role="doc-biblioentry">
Schultz, T Paul. 1994. <span>“Human Capital, Family Planning, and Their Effects on Population Growth.”</span> <em>The American Economic Review</em> 84 (2): 255–60. <a href="http://www.jstor.org/stable/2117839">http://www.jstor.org/stable/2117839</a>.
</div>
<div id="ref-Sevoyan2013-am" class="csl-entry" role="doc-biblioentry">
Sevoyan, Arusyak, and Victor Agadjanian. 2013. <span>“Contraception and Abortion in a Low-Fertility Setting: The Role of Seasonal Migration.”</span> <em>International Perspectives on Sexual and Reproductive Health</em> 39 (3): 124–32. <a href="http://dx.doi.org/10.1363/3912413">http://dx.doi.org/10.1363/3912413</a>.
</div>
<div id="ref-Skiles2015-hq" class="csl-entry" role="doc-biblioentry">
Skiles, Martha Priedeman, Marc Cunningham, Andrew Inglis, Becky Wilkes, Ben Hatch, Ariella Bock, and Janine Barden-O’Fallon. 2015. <span>“The Effect of Access to Contraceptive Services on Injectable Use and Demand for Family Planning in Malawi.”</span> <em>International Perspectives on Sexual and Reproductive Health</em> 41 (1): 20–30. <a href="http://dx.doi.org/10.1363/4102015">http://dx.doi.org/10.1363/4102015</a>.
</div>
</div>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Unmet%20need%20for%20family%20planning%20after%20internal%20migration&amp;url=https%3A%2F%2Fipums.github.io%2Fpma-data-hub%2Fposts%2F2021-04-01-et-internal-migration%2F" aria-label="share on twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fipums.github.io%2Fpma-data-hub%2Fposts%2F2021-04-01-et-internal-migration%2F&amp;title=Unmet%20need%20for%20family%20planning%20after%20internal%20migration" aria-label="share on linkedin">
        <i class="fab fa-linkedin" aria-hidden="true"></i>
      </a>
      <a href="https://www.facebook.com/sharer/sharer.php?s=100&amp;p[url]=https%3A%2F%2Fipums.github.io%2Fpma-data-hub%2Fposts%2F2021-04-01-et-internal-migration%2F" aria-label="share on facebook">
        <i class="fab fa-facebook" aria-hidden="true"></i>
      </a>
    </span>
  </p>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="references">References</h3>
  <div id="references-listing"></div>
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/ipums/pma-data-hub/issues/new">create an issue</a> on the source repository.</p>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>Developed by <a href="https://www.ipums.org">IPUMS</a> at the
University of Minnesota</p>
<p>Licensed under the
<a href="https://www.mozilla.org/en-US/MPL/2.0/">Mozilla Public License
Version 2.0</a></p>
<p>Site built with <a href="https://rstudio.github.io/distill/">Distill
for R Markdown</a></p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
