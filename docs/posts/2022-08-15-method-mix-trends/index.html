<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { color: #00769e; background-color: #f1f3f5; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #00769e; } /* Normal */
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #657422; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #00769e; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #00769e; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #00769e; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #5e5e5e; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>


  <!--radix_placeholder_meta_tags-->
<title>Data Analysis Hub: Trends in Modern Contraceptive Method Mix</title>

<meta property="description" itemprop="description" content="Which methods are have gained popularity among modern method users since 2014?"/>

<link rel="canonical" href="https://ipums.github.io/pma-data-hub/posts/2022-08-15-method-mix-trends/"/>
<link rel="icon" type="image/png" href="../../images/favicon/favicon-32x32.png"/>

<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2022-08-25"/>
<meta property="article:created" itemprop="dateCreated" content="2022-08-25"/>
<meta name="article:author" content="Matt Gunther"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="Data Analysis Hub: Trends in Modern Contraceptive Method Mix"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Which methods are have gained popularity among modern method users since 2014?"/>
<meta property="og:url" content="https://ipums.github.io/pma-data-hub/posts/2022-08-15-method-mix-trends/"/>
<meta property="og:image" content="https://ipums.github.io/pma-data-hub/posts/2022-08-15-method-mix-trends/method-mix-trends_files/figure-html5/unnamed-chunk-16-1.png"/>
<meta property="og:image:width" content="2688"/>
<meta property="og:image:height" content="1920"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="Data Analysis Hub"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary_large_image"/>
<meta property="twitter:title" content="Data Analysis Hub: Trends in Modern Contraceptive Method Mix"/>
<meta property="twitter:description" content="Which methods are have gained popularity among modern method users since 2014?"/>
<meta property="twitter:url" content="https://ipums.github.io/pma-data-hub/posts/2022-08-15-method-mix-trends/"/>
<meta property="twitter:image" content="https://ipums.github.io/pma-data-hub/posts/2022-08-15-method-mix-trends/method-mix-trends_files/figure-html5/unnamed-chunk-16-1.png"/>
<meta property="twitter:image:width" content="2688"/>
<meta property="twitter:image:height" content="1920"/>
<meta property="twitter:site" content="@ipumsGH"/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output","categories","canonical_url"]}},"value":[{"type":"character","attributes":{},"value":["Trends in Modern Contraceptive Method Mix"]},{"type":"character","attributes":{},"value":["Which methods are have gained popularity among modern method users since 2014?"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","affiliation"]}},"value":[{"type":"character","attributes":{},"value":["Matt Gunther"]},{"type":"character","attributes":{},"value":["IPUMS PMA Senior Data Analyst"]}]}]},{"type":"character","attributes":{},"value":["2022-08-25"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained","toc","toc_depth","toc_float"]}},"value":[{"type":"logical","attributes":{},"value":[false]},{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[3]},{"type":"logical","attributes":{},"value":[true]}]}]},{"type":"character","attributes":{},"value":["Modern Method Mix","Indicators","Measurement","Data Analysis","Data Visualization"]},{"type":"character","attributes":{},"value":["https://ipums.github.io/pma-data-hub/posts/2022-08-15-method-mix-trends/"]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["data/disagg.rds","data/pma_00165.dat.gz","data/pma_00165.xml","images/bf2021.png","images/codes.png","images/comp.png","images/fpcurr.png","images/fpnowus.png","images/inj.png","method-mix-trends_files/anchor-4.2.2/anchor.min.js","method-mix-trends_files/bowser-1.9.3/bowser.min.js","method-mix-trends_files/distill-2.2.21/template.v2.js","method-mix-trends_files/figure-html5/unnamed-chunk-14-1.png","method-mix-trends_files/figure-html5/unnamed-chunk-16-1.png","method-mix-trends_files/figure-html5/unnamed-chunk-17-1.png","method-mix-trends_files/figure-html5/unnamed-chunk-18-1.png","method-mix-trends_files/figure-html5/unnamed-chunk-19-1.png","method-mix-trends_files/figure-html5/unnamed-chunk-20-1.png","method-mix-trends_files/figure-html5/unnamed-chunk-21-1.png","method-mix-trends_files/figure-html5/unnamed-chunk-22-1.png","method-mix-trends_files/figure-html5/unnamed-chunk-23-1.png","method-mix-trends_files/header-attrs-2.14/header-attrs.js","method-mix-trends_files/jquery-3.6.0/jquery-3.6.0.js","method-mix-trends_files/jquery-3.6.0/jquery-3.6.0.min.js","method-mix-trends_files/jquery-3.6.0/jquery-3.6.0.min.map","method-mix-trends_files/popper-2.6.0/popper.min.js","method-mix-trends_files/tippy-6.2.7/tippy-bundle.umd.min.js","method-mix-trends_files/tippy-6.2.7/tippy-light-border.css","method-mix-trends_files/tippy-6.2.7/tippy.css","method-mix-trends_files/tippy-6.2.7/tippy.umd.min.js","method-mix-trends_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<script src="../../site_libs/autocomplete-0.37.1/autocomplete.min.js"></script>
<script src="../../site_libs/fuse-6.4.1/fuse.min.js"></script>

<script type="application/javascript">

function getMeta(metaName) {
  var metas = document.getElementsByTagName('meta');
  for (let i = 0; i < metas.length; i++) {
    if (metas[i].getAttribute('name') === metaName) {
      return metas[i].getAttribute('content');
    }
  }
  return '';
}

function offsetURL(url) {
  var offset = getMeta('distill:offset');
  return offset ? offset + '/' + url : url;
}

function createFuseIndex() {

  // create fuse index
  var options = {
    keys: [
      { name: 'title', weight: 20 },
      { name: 'categories', weight: 15 },
      { name: 'description', weight: 10 },
      { name: 'contents', weight: 5 },
    ],
    ignoreLocation: true,
    threshold: 0
  };
  var fuse = new window.Fuse([], options);

  // fetch the main search.json
  return fetch(offsetURL('search.json'))
    .then(function(response) {
      if (response.status == 200) {
        return response.json().then(function(json) {
          // index main articles
          json.articles.forEach(function(article) {
            fuse.add(article);
          });
          // download collections and index their articles
          return Promise.all(json.collections.map(function(collection) {
            return fetch(offsetURL(collection)).then(function(response) {
              if (response.status === 200) {
                return response.json().then(function(articles) {
                  articles.forEach(function(article) {
                    fuse.add(article);
                  });
                })
              } else {
                return Promise.reject(
                  new Error('Unexpected status from search index request: ' +
                            response.status)
                );
              }
            });
          })).then(function() {
            return fuse;
          });
        });

      } else {
        return Promise.reject(
          new Error('Unexpected status from search index request: ' +
                      response.status)
        );
      }
    });
}

window.document.addEventListener("DOMContentLoaded", function (event) {

  // get search element (bail if we don't have one)
  var searchEl = window.document.getElementById('distill-search');
  if (!searchEl)
    return;

  createFuseIndex()
    .then(function(fuse) {

      // make search box visible
      searchEl.classList.remove('hidden');

      // initialize autocomplete
      var options = {
        autoselect: true,
        hint: false,
        minLength: 2,
      };
      window.autocomplete(searchEl, options, [{
        source: function(query, callback) {
          const searchOptions = {
            isCaseSensitive: false,
            shouldSort: true,
            minMatchCharLength: 2,
            limit: 10,
          };
          var results = fuse.search(query, searchOptions);
          callback(results
            .map(function(result) { return result.item; })
          );
        },
        templates: {
          suggestion: function(suggestion) {
            var img = suggestion.preview && Object.keys(suggestion.preview).length > 0
              ? `<img src="${offsetURL(suggestion.preview)}"</img>`
              : '';
            var html = `
              <div class="search-item">
                <h3>${suggestion.title}</h3>
                <div class="search-item-description">
                  ${suggestion.description || ''}
                </div>
                <div class="search-item-preview">
                  ${img}
                </div>
              </div>
            `;
            return html;
          }
        }
      }]).on('autocomplete:selected', function(event, suggestion) {
        window.location.href = offsetURL(suggestion.path);
      });
      // remove inline display style on autocompleter (we want to
      // manage responsive display via css)
      $('.algolia-autocomplete').css("display", "");
    })
    .catch(function(error) {
      console.log(error);
    });

});

</script>

<style type="text/css">

.nav-search {
  font-size: x-small;
}

/* Algolioa Autocomplete */

.algolia-autocomplete {
  display: inline-block;
  margin-left: 10px;
  vertical-align: sub;
  background-color: white;
  color: black;
  padding: 6px;
  padding-top: 8px;
  padding-bottom: 0;
  border-radius: 6px;
  border: 1px #0F2E3D solid;
  width: 180px;
}


@media screen and (max-width: 768px) {
  .distill-site-nav .algolia-autocomplete {
    display: none;
    visibility: hidden;
  }
  .distill-site-nav.responsive .algolia-autocomplete {
    display: inline-block;
    visibility: visible;
  }
  .distill-site-nav.responsive .algolia-autocomplete .aa-dropdown-menu {
    margin-left: 0;
    width: 400px;
    max-height: 400px;
  }
}

.algolia-autocomplete .aa-input, .algolia-autocomplete .aa-hint {
  width: 90%;
  outline: none;
  border: none;
}

.algolia-autocomplete .aa-hint {
  color: #999;
}
.algolia-autocomplete .aa-dropdown-menu {
  width: 550px;
  max-height: 70vh;
  overflow-x: visible;
  overflow-y: scroll;
  padding: 5px;
  margin-top: 3px;
  margin-left: -150px;
  background-color: #fff;
  border-radius: 5px;
  border: 1px solid #999;
  border-top: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion {
  cursor: pointer;
  padding: 5px 4px;
  border-bottom: 1px solid #eee;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion:last-of-type {
  border-bottom: none;
  margin-bottom: 2px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item {
  overflow: hidden;
  font-size: 0.8em;
  line-height: 1.4em;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item h3 {
  font-size: 1rem;
  margin-block-start: 0;
  margin-block-end: 5px;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-description {
  display: inline-block;
  overflow: hidden;
  height: 2.8em;
  width: 80%;
  margin-right: 4%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview {
  display: inline-block;
  width: 15%;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img {
  height: 3em;
  width: auto;
  display: none;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion .search-item-preview img[src] {
  display: initial;
}

.algolia-autocomplete .aa-dropdown-menu .aa-suggestion.aa-cursor {
  background-color: #eee;
}
.algolia-autocomplete .aa-dropdown-menu .aa-suggestion em {
  font-weight: bold;
  font-style: normal;
}

</style>


<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      if ($(this).children()[0].nodeName == "D-FOOTNOTE") {
        var fn = $(this).children()[0]
        $(this).html(fn.shadowRoot.querySelector("sup"))
        $(this).id = fn.id
        fn.remove()
      }
      var refs = $(this).attr('data-cites').split(" ");
      var refHtml = refs.map(function(ref) {
        return "<p>" + $('#ref-' + ref).html() + "</p>";
      }).join("\n");
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // fix footnotes in tables (#411)
    // replacing broken distill.pub feature
    $('table d-footnote').each(function() {
      // we replace internal showAtNode methode which is triggered when hovering a footnote
      this.hoverBox.showAtNode = function(node) {
        // ported from https://github.com/distillpub/template/pull/105/files
        calcOffset = function(elem) {
            let x = elem.offsetLeft;
            let y = elem.offsetTop;
            // Traverse upwards until an `absolute` element is found or `elem`
            // becomes null.
            while (elem = elem.offsetParent && elem.style.position != 'absolute') {
                x += elem.offsetLeft;
                y += elem.offsetTop;
            }

            return { left: x, top: y };
        }
        // https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop
        const bbox = node.getBoundingClientRect();
        const offset = calcOffset(node);
        this.show([offset.left + bbox.width, offset.top + bbox.height]);
      }
    })

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    // ignore leaflet img layers (#106)
    figures = figures.filter(':not(img[class*="leaflet"])')
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace(/^index[.]html/, "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */

@import url('https://assets.ipums.org/_css/font-faces.css');

html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #00263A;
  --header-color:    #00263A;
  --body-color:      #00263A;
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    cabrito_sans_norm_regular;
  --mono-font:       Menlo, Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-font:       cabrito_sans_norm_regular;
  --navbar-font:     cabrito_sans_norm_regular;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #00263A;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #00263A;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */

h1{
  font-family: 'cabrito_sans_norm_regular';
  text-transform: uppercase;
  color: #00263A;
}

d-title h1{
  font-weight: 500;
}

d-article h1{
  font-size: 36px;
  line-height: 1.1em;
  font-weight: 100;
}

d-article h2{
    font-size: 30px;
    font-family: "cabrito_sans_cond_demi";
    text-transform: uppercase;
    color: #00263A;
    font-weight: 100;
}

d-article h3{
  font-size: 26px;
  font-family: 'cabrito_sans_cond_demi';
  color: #00263A;
  margin-top: 1.5rem;
  margin-bottom: 1em;
  font-weight: 100;
}

d-article h4{
  font-size: 24px;
  font-family: 'cabrito_sans_norm_regular';
  color: #00263A;
  text-transform: unset;
  margin-top: 1.5rem;
  margin-bottom: 1em;
  font-weight: 100;
}

d-article h5{
  font-size: 24px;
  font-family: 'cabrito_sans_cond_demi';
  color: #00263A;
  margin-top: 1.5rem;
  margin-bottom: 1em;
  font-weight: 100;
}

d-article li {
    margin-bottom: 0;
    margin-left: 1rem;
    padding-left: 0;
    color: #00263A;
}

d-article table {
    color: #00263A;
}
.d-contents nav > ul > li > a {
    font-weight: 100;
}

body{
  font-family: 'cabrito_subset';
}

b, strong {
  font-family: "cabrito_sans_cond_demi";
  font-weight: 100;
}

p>a {
    color: #98579B
}

li>a {
    color: #98579B;
}

.btn {
    font-family: "cabrito_subset";
    font-size: 16px;
    background-color: #F0E6F0;
    margin-bottom: 20px;
    border-width: 1px;
    padding-top: 6px;
    padding-bottom: 6px;
    cursor: pointer;
}

.distill-site-header .title {
    text-transform: uppercase;
    line-height: 38px;
    vertical-align: middle;
}

.distill-site-header .logo img{
  max-height: 50px; /* Makes logo bigger, default was 20px */
  vertical-align: middle;
  margin-bottom: 0;
}

.distill-site-header .nav-right {
    float: right;
    line-height: 38px;
    vertical-align: middle;
}

.distill-site-header .nav-left {
    display: inline-block;
    line-height: 38px;
    vertical-align: middle;
}

.algolia-autocomplete {
  line-height: 25px;
}

d-article iframe {
    border: 0;
    margin-bottom: 0;
    width: 100%;
}

d-article aside a {
  color: #98579B;
}

@media(max-width: 767px){
  aside{
    width: 50%;
    position: relative;
    left: 25%;
    padding-bottom: 20px;
  }
}

code {
  font-family: Menlo, Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.14/header-attrs.js"></script>
  <script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<script type="text/javascript" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=UA-191039907-2"></script>
<script type="text/javascript" cookie-consent="tracking">
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'UA-191039907-2');
</script>
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Trends in Modern Contraceptive Method Mix","description":"Which methods are have gained popularity among modern method users since 2014?","authors":[{"author":"Matt Gunther","authorURL":"#","affiliation":"IPUMS PMA Senior Data Analyst","affiliationURL":"#","orcidID":""}],"publishedDate":"2022-08-25T00:00:00.000-04:00","citationText":"Gunther, 2022"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a class="logo" href="https://pma.ipums.org/pma/">
<img src="../../images/logo-white.png" alt="Logo"/>
</a>
<a href="../../index.html" class="title">Data Analysis Hub</a>
<input id="distill-search" class="nav-search hidden" type="text" placeholder="Search..."/>
</div>
<div class="nav-right">
<a href="../../index.html">Posts</a>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Courses
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../introduction.html">Introduction to IPUMS PMA Data Analysis</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
R Tips
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../posts/2020-12-10-get-ipums-pma-data/index.html">Import IPUMS PMA Data into R</a>
<a href="../../posts/2020-12-10-get-r-and-packages/index.html">R, RStudio, and R Packages</a>
<a href="../../posts/2021-11-15-find-an-example/index.html">Find an Example</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Community
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../CONTRIBUTING.html">Contributing guide</a>
<a href="../../CODE_OF_CONDUCT.html">Code of conduct</a>
<a href="../../LICENSE.html">License</a>
<a href="https://github.com/ipums/pma-data-hub/">GitHub</a>
</div>
</div>
<a href="../../about.html">About</a>
<a href="../../index.xml">
<i class="fa fa-rss" aria-hidden="true"></i>
</a>
<a href="https://twitter.com/ipumsGH">
<i class="fab fa-twitter" aria-hidden="true"></i>
</a>
<a href="https://github.com/ipums/pma-data-hub" aria-label="Link to source">
<i class="fab fa-github" aria-hidden="true"></i>
</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Trends in Modern Contraceptive Method Mix</h1>
<!--radix_placeholder_categories-->
<div class="dt-tags">
  <a href="../../index.html#category:Modern_Method_Mix" class="dt-tag">Modern Method Mix</a>
  <a href="../../index.html#category:Indicators" class="dt-tag">Indicators</a>
  <a href="../../index.html#category:Measurement" class="dt-tag">Measurement</a>
  <a href="../../index.html#category:Data_Analysis" class="dt-tag">Data Analysis</a>
  <a href="../../index.html#category:Data_Visualization" class="dt-tag">Data Visualization</a>
</div>
<!--/radix_placeholder_categories-->
<p><p>Which methods are have gained popularity among modern method users
since 2014?</p></p>
</div>

<div class="d-byline">
  Matt Gunther  (IPUMS PMA Senior Data Analyst)
  
<br/>2022-08-25
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#setup">Setup</a></li>
<li><a href="#most-effective-method">Most Effective Method</a>
<ul>
<li><a href="#recoding">Recoding</a></li>
</ul></li>
<li><a href="#modern-method-users">Modern Method Users</a>
<ul>
<li><a href="#missing-values">Missing values</a></li>
</ul></li>
<li><a href="#modern-method-mix">Modern Method Mix</a></li>
<li><a href="#data-visualization">Data Visualization</a></li>
<li><a href="#disaggregation">Disaggregation</a></li>
</ul>
</nav>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<p>Modern Contraceptive Method Mix is a core indicator in the <a
href="https://fp2030.org/what-we-measure">FP2030 Measurement
Framework</a> representing <strong>the distribution of modern method
users by method</strong>. Researchers use this distribution to
understand which family planning methods are preferred and accessible in
a particular place.</p>
<blockquote>
<p>While there is no right method mix or ideal method, there is
general agreement that providing access to a wide variety of methods is
both a component of quality of care as well as an important principle of
rights-based family planning.</p>
<footer>
 <a
href="http://2015-2016progress.familyplanning2020.org/page/measurement/modern-contraceptive-method-mix-indicator-9">FP2030
Core Indicators</a>
</footer>
</blockquote>
<p>Modern Method Mix can change year-to-year in response to the
introduction of new methods in-country, access restrictions
(e.g.stockouts), increased need for specific methods (e.g.those that
protect against sexually transmitted infections), and shifting user
preferences.<a href="#fn1" class="footnote-ref" id="fnref1"
role="doc-noteref"><sup>1</sup></a> Cross-sectional PMA surveys are
fielded approximately once per year, allowing researchers to monitor
these changes at annual intervals. Typically, youll find Trends in
Modern Contraceptive Mix updated in the <a
href="https://www.pmadata.org/data/survey-results-summaries">PMA Survey
Results Summary</a> published for each new sample.</p>
<div class="layout-chunk" data-layout="l-body">
<p><img src="images/bf2021.png" width="1163" style="display: block; margin: auto;" /></p>
</div>
<aside>
<p><strong>Source:</strong></p>
<p><a
href="https://www.pmadata.org/sites/default/files/data_product_results/Burkina%20National_Phase%202_XS_Results%20Brief_English_Final_17Sep2021.pdf">Burkina
Faso Phase 2</a></p>
Cross-sectional Survey Results Summary
</aside>
<p>In this post, well show how you can make a graphic similar to this
one in R using a single data extract downloaded from <a
href="https://pma.ipums.org">IPUMS PMA</a>. Well be focusing on Modern
Method Mix, but we recommend using IPUMS data any time you want to
investigate how indicators change over time or how they compare across
populations. Thats because the IPUMS PMA data extract system is
designed both to allow researchers to combine data from multiple samples
and to flag important comparability issues between those samples.</p>
<h1 id="setup">Setup</h1>
<p>You can compare trends in Modern Method Mix for any number of PMA
samples with a single data extract from IPUMS PMA. Here, well
illustrate using data from two countries, Burkina Faso and Kenya, where
cross-sectional data have been collected continuously between 2014 and
2021.</p>
<table>
<thead>
<tr class="header">
<th>Country</th>
<th>Sample Year</th>
<th>Data Collection Period</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Burkina Faso</td>
<td>2014</td>
<td>Nov 2014 - Jan 2015</td>
</tr>
<tr class="even">
<td></td>
<td>2015</td>
<td>Apr 2015 - June 2015</td>
</tr>
<tr class="odd">
<td></td>
<td>2016a</td>
<td>Mar 2016 - Apr 2016</td>
</tr>
<tr class="even">
<td></td>
<td>2016b</td>
<td>Nov 2016 - Feb 2017</td>
</tr>
<tr class="odd">
<td></td>
<td>2017</td>
<td>Nov 2017 - Jan 2018</td>
</tr>
<tr class="even">
<td></td>
<td>2018</td>
<td>Dec 2018 - Jan 2019</td>
</tr>
<tr class="odd">
<td></td>
<td>2020</td>
<td>Dec 2019 - Feb 2020</td>
</tr>
<tr class="even">
<td></td>
<td>2021</td>
<td>Dec 2020 - Mar 2021</td>
</tr>
<tr class="odd">
<td>Kenya</td>
<td>2014a</td>
<td>May 2014 - Aug 2014</td>
</tr>
<tr class="even">
<td></td>
<td>2014b</td>
<td>Nov 2014 - Dec 2014</td>
</tr>
<tr class="odd">
<td></td>
<td>2015a</td>
<td>Jun 2015 - Jul 2015</td>
</tr>
<tr class="even">
<td></td>
<td>2015b</td>
<td>Nov 2015 - Dec 2015</td>
</tr>
<tr class="odd">
<td></td>
<td>2016</td>
<td>Nov 2016 - Dec 2016</td>
</tr>
<tr class="even">
<td></td>
<td>2017</td>
<td>Nov 2017 - Dec 2017</td>
</tr>
<tr class="odd">
<td></td>
<td>2018</td>
<td>Nov 2018 - Jan 2019</td>
</tr>
<tr class="even">
<td></td>
<td>2019</td>
<td>Nov 2019 - Dec 2019</td>
</tr>
<tr class="odd">
<td></td>
<td>2020</td>
<td>Nov 2020 - Dec 2020</td>
</tr>
</tbody>
</table>
<aside>
<p>This extract includes <strong>cross-sectional</strong> samples for
Burkina Faso and Kenya.</p>
For information on <strong>panel data</strong> collected in 2019-2020,
see our <a href="../../index.html#category:Panel_Data">longitudinal
guide</a>.
</aside>
<p>Our extract will contain all of these cross-sectional samples,
filtered to include <a
href="https://pma.ipums.org/pma-action/samples">only Female
Respondents</a>. It will also contain the following variables:</p>
<ul>
<li><a
href="https://pma.ipums.org/pma-action/variables/SAMPLE#codes_section">SAMPLE</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/COUNTRY#codes_section">COUNTRY</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/YEAR#codes_section">YEAR</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/INTFQMON#codes_section">INTFQMON</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/INTFQYEAR#codes_section">INTFQYEAR</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/FQWEIGHT#codes_section">FQWEIGHT</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/EAID#codes_section">EAID</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/STRATA#codes_section">STRATA</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/RESIDENT#codes_section">RESIDENT</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/LASTDOBCMC#codes_section">LASTDOBCMC</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/TIMEMENSTRUATE#codes_section">TIMEMENSTRUATE</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/TIMEMENSTRUATEVAL#codes_section">TIMEMENSTRUATEVAL</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/MCP#codes_section">MCP</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/FPCURRUSE#codes_section">FPCURRUSE</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/FPCURREFFMETH#codes_section">FPCURREFFMETH</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/FPCURREFFMETHRC#codes_section">FPCURREFFMETHRC</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/FPEFFECTIVEYR#codes_section">FPEFFECTIVEYR</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/FPCURRINJTYPE#codes_section">FPCURRINJTYPE</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/FP1STMETHOD#codes_section">FP1STMETHOD</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/MARSTAT#codes_section">MARSTAT</a></li>
<li><a
href="https://pma.ipums.org/pma-action/variables/AGE#codes_section">AGE</a></li>
</ul>
<p>Well load the extract and a few key packages into R like so:</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Load packages </span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://www.ipums.org'>ipumsr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidyverse.tidyverse.org'>tidyverse</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://gdfe.co/srvyr/'>srvyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='http://corybrunson.github.io/ggalluvial/'>ggalluvial</a></span><span class='op'>)</span>

<span class='co'># Load data extract </span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/ipumsr/man/read_ipums_micro.html'>read_ipums_micro</a></span><span class='op'>(</span>
  ddi <span class='op'>=</span> <span class='st'>"data/pma_00165.xml"</span>,
  data <span class='op'>=</span> <span class='st'>"data/pma_00165.dat.gz"</span>
<span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Additionally, well modify a few variables to improve
readability:</p>
<ul>
<li>A <a
href="../2022-05-15-phase2-calendar/#century-month-codes-cmc">Century
Month Code (CMC)</a> we call <code>INTFQCMC</code> will be created for
each individual womans interview date<a href="#fn2"
class="footnote-ref" id="fnref2"
role="doc-noteref"><sup>2</sup></a></li>
<li>Well store the median interview date for each sample in
<code>INTFQMED</code></li>
<li>All key categorical variables will be recoded with <a
href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></li>
</ul>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>SAMPLE</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    INTFQCMC <span class='op'>=</span> <span class='fl'>12</span><span class='op'>*</span><span class='op'>(</span><span class='va'>INTFQYEAR</span> <span class='op'>-</span> <span class='fl'>1900</span><span class='op'>)</span> <span class='op'>+</span> <span class='va'>INTFQMON</span>,
    INTFQMED <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/median.html'>median</a></span><span class='op'>(</span><span class='va'>INTFQCMC</span><span class='op'>)</span>, 
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/across.html'>across</a></span><span class='op'>(</span>
      <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>COUNTRY</span>, <span class='va'>INTFQMON</span>, <span class='va'>TIMEMENSTRUATE</span>, <span class='va'>MCP</span>, <span class='va'>FPCURRUSE</span>, <span class='va'>FPCURREFFMETH</span>,
        <span class='va'>FPCURREFFMETHRC</span>, <span class='va'>FPEFFECTIVEYR</span>, <span class='va'>FPCURRINJTYPE</span>, <span class='va'>FP1STMETHOD</span>, <span class='va'>MARSTAT</span><span class='op'>)</span>,
      <span class='va'>as_factor</span>
    <span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/groups.html'>ungroup</a></span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h1 id="most-effective-method">Most Effective Method</h1>
<p>PMA surveys ask each woman to report <em>all</em> family planning
methods she or her partner are currently using to delay or avoid getting
pregnant. The question looks something like this one, where the
respondent is prompted to select all options that apply:</p>
<pre><code>Which method or methods are you using?

PROBE: Anything else?

Select all methods mentioned. 
SCROLL TO THE BOTTOM to see all choices.

  [] Female sterilization
  [] Male sterilization
  [] Implant
  [] IUD
  [] Injectables
  [] Pill
  [] Emergency Contraception
  [] Male condom
  [] Female condom
  [] Diaphragm
  [] Foam/Jelly
  [] Standard Days/Cycle beads
  [] LAM
  [] Rhythm method
  [] Withdrawal
  [] Other traditional method
  [] No response</code></pre>
<aside>
<p><strong>Source:</strong></p>
<p><a
href="https://pma.ipums.org/pma-action/source_documents/enum_form_bf2021a_f_tag.xml#124">Burkina
Faso Phase 2 Questionnaire</a></p>
Method list may vary by sample!
</aside>
<p>Because a woman can report more than one method, PMA ranks the
effectiveness of each method and uses only her <strong>most effective
method</strong> to calculate Modern Method Mix. This ensures that sum of
all methods included in Modern Method Mix is 100%.</p>
<p>Every PMA sample includes a variable <a
href="https://pma.ipums.org/pma-action/variables/FPCURREFFMETH">FPCURREFFMETH</a>
that indicates the most effective method reported by the respondent on
this question. However, its important to note that the list of methods
may vary between samples.</p>
<p>Fortunately, IPUMS makes it easy to identify whether each method is
available for the researchers samples of interest. On the
<code>FPCURREFFMETH</code> <a
href="https://pma.ipums.org/pma-action/variables/FPCURREFFMETH#codes_section">codes
tab</a>, we see the availability of every method in each sample from
Burkina Faso and Kenya.</p>
<div class="layout-chunk" data-layout="l-page">
<p><img src="images/codes.png" width="1218" style="display: block; margin: auto;" /></p>
</div>
<p>Certain methods like N-tablet, Washing, or Other Modern were
included in none of our samples. Others, like Diaphragm and Foam, appear
intermittently: these methods may have been listed on the questionnaire,
but appear unavailable if no women selected the associated response
option (or if they were only selected in combination with a more
effective method).</p>
<p><code>FPCURREFFMETH</code> uses composite coding, where general
categories like Injectables (code 120) are used if a particular
questionnaire did not distinguish between specific sub-categories like
3-month, monthly, or Sayana Press (codes 121, 122, and 123). In Burkina
Faso and Kenya samples, women were not asked to specify injectable type
on this question; however, later samples included the following
supplementary question (accompanied by a visual aid):</p>
<pre><code>Was the injection administered via syringe or small needle?

Show the image to the respondent.

  [] Syringe
  [] Small needle (Sayana Press)
  [] No response</code></pre>
<p>Responses to this question are recorded in the variable <a
href="https://pma.ipums.org/pma-action/variables/FPCURRINJTYPE">FPCURRINJTYPE</a>.
The IPUMS system shows that it was added to Burkina Faso samples
beginning in 2016, and that it was added to Kenya samples beginning in
2018:</p>
<div class="layout-chunk" data-layout="l-page">
<p><img src="images/inj.png" width="1239" style="display: block; margin: auto;" /></p>
</div>
<h2 id="recoding">Recoding</h2>
<p>When the supplementary question associated with
<code>FPCURRINJTYPE</code> was added, PMA released a recoded version of
<strong>most effective method</strong> that youll find in <a
href="https://pma.ipums.org/pma-action/variables/FPCURREFFMETHRC#codes_section">FPCURREFFMETHRC</a>
(the suffix <code>RC</code> indicates recoded). This variable makes
four adjustments to the original variable <code>FPCURREFFMETH</code>
(see <a
href="https://pma.ipums.org/pma-action/variables/FPCURREFFMETHRC#description_section">description
tab</a>):</p>
<ol type="1">
<li>Women who report Sayana Press in <code>FPCURRINJTYPE</code> are
differentiated from those using 3-month injectables. (Sayana Press users
are identified as Injectable (SC) in the graphic at the top of this
post.)</li>
<li>Women who report using the lactational amenorrhea method (LAM) in
<code>FPCURREFFMETH</code> are coded other traditional in
<code>FPCURREFFMETHRC</code> if they fail to meet the criteria for
effective use of LAM. Specifically, LAM users must be less than six
months post-partum (see <a
href="https://pma.ipums.org/pma-action/variables/LASTDOBCMC">LASTDOBCMC</a>)
and amenorrheic / not currently menstruating (see <a
href="https://pma.ipums.org/pma-action/variables/TIMEMENSTRUATE">TIMEMENSTRUATE</a>
and <a
href="https://pma.ipums.org/pma-action/variables/TIMEMENSTRUATEVAL">TIMEMENSTRUATEVAL</a>).</li>
<li>Women who did not report current use of a contraceptive method
(coded NIU (not in universe) in <code>FPCURREFFMETH</code>) are coded
emergency contraception in <code>FPCURREFFMETHRC</code> if they
reported using an emergency method at all in the last 12 months (see <a
href="https://pma.ipums.org/pma-action/variables/FPEFFECTIVEYR">FPEFFECTIVEYR</a>,
or <a
href="https://pma.ipums.org/pma-action/variables/FPECUSYR">FPECUSYR</a>
for later samples).</li>
<li>Women who did not report using Female Sterilization as a current
method in <code>FPCURREFFMETH</code> are coded female sterilization if
they indicated elsewhere that they had been sterilized (see <a
href="https://pma.ipums.org/pma-action/variables/FP1STMETHOD">FP1STMETHOD</a>).</li>
</ol>
<p>PMA uses <code>FPCURREFFMETHRC</code> in its calculation of Modern
Method Mix, but <code>FPCURREFFMETHRC</code> was not retroactively added
to older samples. Well demonstrate how to recode
<code>FPCURREFFMETH</code> manually for samples where
<code>FPCURREFFMETHRC</code> is not available.</p>
<p>Notably, we wont be able to identify users of Sayana Press for
samples prior to the introduction of <code>FPCURRINJTYPE</code> (this
explains the apparent growth from 0% in June 2015 to 5% in May 2016 in
the Burkina Faso graphic at the top of this post).</p>
<p>Instead, well begin with the adjustment made for LAM users who are
not post-partum amenorrheic (PPA). Unfortunately, PMA does not include a
variable indicating whether women are PPA, so well need to make our own
variable called <code>PPA</code>.</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># `TIMEMENSTRUATE` gives a unit, while `TIMEMENSTRUATEVAL` gives a value</span>
<span class='co'># We use these variables to calculate months since last period: `MENSTR_MOS`</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    MENSTR_MOS <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
      <span class='va'>TIMEMENSTRUATE</span> <span class='op'>==</span> <span class='st'>"Days"</span> <span class='op'>~</span> <span class='va'>TIMEMENSTRUATEVAL</span> <span class='op'>/</span> <span class='fl'>30</span>,
      <span class='va'>TIMEMENSTRUATE</span> <span class='op'>==</span> <span class='st'>"Weeks"</span> <span class='op'>~</span> <span class='va'>TIMEMENSTRUATEVAL</span> <span class='op'>/</span> <span class='fl'>4</span>,
      <span class='va'>TIMEMENSTRUATE</span> <span class='op'>==</span> <span class='st'>"Months"</span> <span class='op'>~</span> <span class='va'>TIMEMENSTRUATEVAL</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> <span class='va'>as.double</span>,
      <span class='va'>TIMEMENSTRUATE</span> <span class='op'>==</span> <span class='st'>"Years"</span> <span class='op'>~</span> <span class='va'>TIMEMENSTRUATEVAL</span> <span class='op'>*</span> <span class='fl'>12</span>
    <span class='op'>)</span> 
  <span class='op'>)</span>

<span class='co'># `INTFQCMC` gives the month of the interview, while</span>
<span class='co'># `LASTDOBCMC` gives the month of most recent birth (or 9999 for no prior birth) </span>
<span class='co'># The difference is the number of months since last birth: `BIRTH_MOS`</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    BIRTH_MOS <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
      <span class='va'>LASTDOBCMC</span> <span class='op'>&lt;</span> <span class='fl'>9000</span> <span class='op'>~</span> <span class='va'>INTFQCMC</span> <span class='op'>-</span> <span class='va'>LASTDOBCMC</span>
    <span class='op'>)</span> 
  <span class='op'>)</span>

<span class='co'># `TIMEMENSTRUATE` can also be "Before last birth" </span>
<span class='co'># If so, or if MENSTR_MOS &gt; BIRTH_MOS, women who gave birth &lt; 6 months are PPA</span>
<span class='co'># All others are not PPA (or NA if most recent period cannot be determined)</span>
<span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    PPA <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
      <span class='va'>BIRTH_MOS</span> <span class='op'>&lt;</span> <span class='fl'>6</span> <span class='op'>&amp;</span> <span class='va'>TIMEMENSTRUATE</span> <span class='op'>==</span> <span class='st'>"Before last birth"</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,
      <span class='va'>BIRTH_MOS</span> <span class='op'>&lt;</span> <span class='fl'>6</span> <span class='op'>&amp;</span> <span class='va'>MENSTR_MOS</span> <span class='op'>&gt;</span> <span class='va'>BIRTH_MOS</span> <span class='op'>~</span> <span class='cn'>TRUE</span>,
      <span class='va'>BIRTH_MOS</span> <span class='op'>&gt;=</span> <span class='fl'>6</span> <span class='op'>|</span> <span class='va'>LASTDOBCMC</span> <span class='op'>&gt;</span> <span class='fl'>9000</span> <span class='op'>~</span> <span class='cn'>FALSE</span>
    <span class='op'>)</span>
  <span class='op'>)</span> 
</code></pre>
</div>
</div>
<p>We use our <code>PPA</code> variable together with
<code>FP1STMETHOD</code> and <code>FPEFFECTIVEYR</code> to manually
build <code>FPCURREFFMETHRC</code> for early samples where it is not
available. Otherwise, we use the version of <code>FPCURREFFMETHRC</code>
provided by PMA for later samples.</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    FPCURREFFMETHRC <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
      <span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>`FPCURREFFMETHRC`</span><span class='op'>)</span> <span class='op'>~</span> <span class='va'>FPCURREFFMETHRC</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> <span class='va'>as_factor</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> <span class='va'>as.character</span>,
      <span class='va'>FP1STMETHOD</span> <span class='op'>==</span> <span class='st'>"Female sterilization"</span> <span class='op'>~</span> <span class='st'>"Female Sterilization"</span>,
      <span class='va'>FPCURRUSE</span> <span class='op'>!=</span> <span class='st'>"Yes"</span> <span class='op'>&amp;</span> <span class='va'>FPEFFECTIVEYR</span> <span class='op'>==</span> <span class='st'>"Emergency Contraception"</span> <span class='op'>~</span> <span class='st'>"Emergency Contraception"</span>,
      <span class='va'>FPCURREFFMETH</span> <span class='op'>==</span> <span class='st'>"Lactational amenorrhea method (LAM)"</span> <span class='op'>&amp;</span> <span class='op'>!</span><span class='va'>PPA</span> <span class='op'>~</span> <span class='st'>"Other traditional"</span>,
      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='va'>FPCURREFFMETH</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> <span class='va'>as_factor</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> <span class='va'>as.character</span>
    <span class='op'>)</span>
  <span class='op'>)</span>
</code></pre>
</div>
</div>
<p>You can review the changes made to <code>FPCURREFFMETH</code> in
<code>FPCURREFFMETHRC</code> like so:</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='va'>FPCURREFFMETH</span> <span class='op'>!=</span> <span class='va'>FPCURREFFMETHRC</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='va'>FPCURREFFMETH</span>, <span class='va'>FPCURREFFMETHRC</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 7  3
  FPCURREFFMETH                       FPCURREFFMETHRC                n
  &lt;fct&gt;                               &lt;chr&gt;                      &lt;int&gt;
1 IUD                                 Female Sterilization           1
2 Injectables (3 months)              Female Sterilization           1
3 Injectables (3 months)              Injectables (Sayana Press)   895
4 Female condom                       Female Sterilization           1
5 Lactational amenorrhea method (LAM) Other traditional            108
6 NIU (not in universe)               Emergency Contraception      314
7 NIU (not in universe)               Female Sterilization           7</code></pre>
</div>
<h1 id="modern-method-users">Modern Method Users</h1>
<div>
<p>When we calculate Modern Method Mix, well determine the share of
women who use each method as a proportion of women age 15-49 who use any
modern method. Every PMA sample includes a variable <a
href="https://pma.ipums.org/pma-action/variables/MCP">MCP</a> indicating
whether the woman is currently using a modern method (any method except
Rhythm, Withdrawal, or Other Traditional).</p>
<p><code>MCP</code> also uses the womans <strong>most effective current
method</strong> if she indicates that she is using more than one method.
Fortunately, <code>MCP</code> uses the same recoding logic shown for
<code>FPCURREFFMETHRC</code> above: it adjusts for non-PPA use of LAM,
Emergency Contraception within the past year, and prior sterilization
(see <a
href="https://pma.ipums.org/pma-action/variables/MCP#description_section">description
tab</a> for details). Because <code>MCP</code> is available for every
PMA sample, we need to make no additional changes here.</p>
</div>
<aside>
<p>Modern Method Mix is a proportion among women age 15-49 <strong>who
use modern methods</strong>.</p>
Note that this is different from the <strong>prevalence</strong> of
individual methods, which would reflect the proportion among
<em>all</em> women age 15-49.
</aside>
<h2 id="missing-values">Missing values</h2>
<p><code>MCP</code> includes the values Yes, No, and No response or
missing. If you compare <code>MCP</code> with
<code>FPCURREFFMETH</code>, youll see that there are several cases
where <code>MCP</code> is missing even though the woman reported use
of a method:</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='va'>MCP</span> <span class='op'>==</span> <span class='st'>"No response or missing"</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='va'>MCP</span>, <span class='va'>FPCURREFFMETH</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 14  3
   MCP                    FPCURREFFMETH                           n
   &lt;fct&gt;                  &lt;fct&gt;                               &lt;int&gt;
 1 No response or missing Female Sterilization                    3
 2 No response or missing Implants                              149
 3 No response or missing IUD                                    20
 4 No response or missing Injectables (3 months)                 93
 5 No response or missing Pill                                   36
 6 No response or missing Emergency Contraception                 7
 7 No response or missing Male condom                            48
 8 No response or missing Female condom                           2
 9 No response or missing Standard Days/Cycle Beads Method        5
10 No response or missing Lactational amenorrhea method (LAM)     2
11 No response or missing Rhythm                                 25
12 No response or missing Withdrawal                              4
13 No response or missing Other traditional                       1
14 No response or missing NIU (not in universe)                 805</code></pre>
</div>
<p>How can this be? A strong majority of these cases are women who were
not members of the <em>de facto</em> population of women who slept in
the household during the night before the household screening interview
(see <a
href="https://pma.ipums.org/pma-action/variables/RESIDENT#codes_section">RESIDENT</a>).
As a result, they are not considered part of the analytic sample, and
they are assigned a weight of 0 in <a
href="https://pma.ipums.org/pma-action/variables/FQWEIGHT#codes_section">FQWEIGHT</a>:
these cases drop out in weighted population inference (or we can drop
them ourselves to suppress a warning message).</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='va'>MCP</span> <span class='op'>==</span> <span class='st'>"No response or missing"</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://dplyr.tidyverse.org/reference/count.html'>count</a></span><span class='op'>(</span><span class='va'>FQWEIGHT</span> <span class='op'>==</span> <span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code># A tibble: 2  2
  `FQWEIGHT == 0`     n
  &lt;lgl&gt;           &lt;int&gt;
1 FALSE              35
2 TRUE             1165</code></pre>
</div>
<p>The remaining 35 cases are women who were missing data on one or more
of the variables used in recoding for <code>MCP</code>. Well keep them
in our data in order to calculate the correct degrees of freedom for
each sample.</p>
<h1 id="modern-method-mix">Modern Method Mix</h1>
<p>Finally, were ready to use <code>FPCURREFFMETHRC</code> and
<code>MCP</code> to calculate Modern Method Mix. PMA uses a stratified
cluster-sample design, so well use the variables <a
href="https://pma.ipums.org/pma-action/variables/EAID#codes_section">EAID</a>
and <a
href="https://pma.ipums.org/pma-action/variables/STRATA#codes_section">STRATA</a>
together with <code>FQWEIGHT</code> as survey design information.</p>
<p>Because our data extract contains multiple samples, well need to use
<a
href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a>
to iterate through each independent sample (identified by our labeling
variables <code>COUNTRY</code> and <code>INTFQMED</code>). To make this
easier, well use two <em>nested</em> <a
href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a>
functions:</p>
<ol type="1">
<li>The outer <a
href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a>
function allows us to specify <a
href="http://gdfe.co/srvyr/reference/as_survey_design.html">survey
design information</a> for each independent sample (referenced
iteratively as <a
href="https://dplyr.tidyverse.org/reference/context.html">cur_data</a>)</li>
<li>The inner <a
href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a>
function estimates the proportion of women for each combination of
<code>MCP</code> and <code>FPCURREFFMETHRC</code> in each
population</li>
</ol>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='va'>FQWEIGHT</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>COUNTRY</span>, <span class='va'>INTFQMED</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarise</a></span><span class='op'>(</span>
    .groups <span class='op'>=</span> <span class='st'>"keep"</span>,
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>cur_data</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/as_survey_design.html'>as_survey_design</a></span><span class='op'>(</span>weights <span class='op'>=</span> <span class='va'>FQWEIGHT</span>, ids <span class='op'>=</span> <span class='va'>EAID</span>, strata <span class='op'>=</span> <span class='va'>STRATA</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/group_by.html'>group_by</a></span><span class='op'>(</span>MCP <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/as_factor.html'>as_factor</a></span><span class='op'>(</span><span class='va'>MCP</span><span class='op'>)</span>, <span class='va'>FPCURREFFMETHRC</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='http://gdfe.co/srvyr/reference/survey_mean.html'>survey_mean</a></span><span class='op'>(</span>prop <span class='op'>=</span> <span class='cn'>TRUE</span>, prop_method <span class='op'>=</span> <span class='st'>"logit"</span>, vartype <span class='op'>=</span> <span class='st'>"ci"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span> 
</code></pre>
</div>
<pre><code># A tibble: 288  7
# Groups:   COUNTRY, INTFQMED [17]
   COUNTRY      INTFQMED MCP   FPCURREFFMETHRC                      coef    `_low`  `_upp`
   &lt;fct&gt;           &lt;dbl&gt; &lt;fct&gt; &lt;chr&gt;                               &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
 1 Burkina Faso     1379 No    NIU (not in universe)            0.999    0.996     1.00   
 2 Burkina Faso     1379 No    Other traditional                0.000203 0.0000272 0.00151
 3 Burkina Faso     1379 No    Rhythm                           0.000672 0.0000903 0.00497
 4 Burkina Faso     1379 Yes   Diaphragm                        0.00102  0.000134  0.00765
 5 Burkina Faso     1379 Yes   Emergency Contraception          0.00163  0.000220  0.0120 
 6 Burkina Faso     1379 Yes   Female Sterilization             0.00416  0.00128   0.0135 
 7 Burkina Faso     1379 Yes   Implants                         0.436    0.358     0.518  
 8 Burkina Faso     1379 Yes   Injectables (3 months)           0.363    0.287     0.446  
 9 Burkina Faso     1379 Yes   IUD                              0.0194   0.00836   0.0445 
10 Burkina Faso     1379 Yes   Male condom                      0.0349   0.0157    0.0758 
11 Burkina Faso     1379 Yes   Pill                             0.134    0.0986    0.181  
12 Burkina Faso     1379 Yes   Standard Days/Cycle Beads Method 0.00544  0.00204   0.0144 
13 Burkina Faso     1385 No    NIU (not in universe)            0.989    0.982     0.993  
14 Burkina Faso     1385 No    No response or missing           0.000221 0.0000294 0.00166
15 Burkina Faso     1385 No    Other traditional                0.00121  0.000306  0.00478
16 Burkina Faso     1385 No    Rhythm                           0.00848  0.00514   0.0139 
17 Burkina Faso     1385 No    Withdrawal                       0.00157  0.000502  0.00493
18 Burkina Faso     1385 Yes   Emergency Contraception          0.00463  0.00172   0.0124 
19 Burkina Faso     1385 Yes   Female condom                    0.00287  0.000652  0.0126 
20 Burkina Faso     1385 Yes   Female Sterilization             0.00373  0.00123   0.0113 
#  with 268 more rows
#  Use `print(n = ...)` to see more rows</code></pre>
</div>
<p>Here, <code>coef</code> sums to 100% for each level of
<code>MCP</code>, while the columns <code>_low</code> and
<code>_upp</code> report a 95% confidence interval for each estimate.
Because were only concerned with Modern Method Mix, we can disregard
any rows where <code>MCP != "Yes"</code>.</p>
<h1 id="data-visualization">Data Visualization</h1>
<p>To match the PMA graphic shown at the top of this post, well make a
few minor modifications to our summary table. First, well combine a few
of the lesser-used modern methods under Other Modern Method:</p>
<ul>
<li>Male Sterilization</li>
<li>Female Sterilization</li>
<li>Female Condom</li>
<li>Foam</li>
<li>Standard Days / Cycle Beads</li>
<li>Diaphragm</li>
<li>LAM<a href="#fn3" class="footnote-ref" id="fnref3"
role="doc-noteref"><sup>3</sup></a></li>
</ul>
<p>You can use <a
href="https://forcats.tidyverse.org/reference/fct_collapse.html">fct_collapse</a>
to combine several factors levels into a new level like other.
Conveniently, you can also use it to relabel levels as shown here for
Implant, Injectable (IM), Injectable (SC), and Emergency
contraception:</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>dat</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    FPCURREFFMETHRC <span class='op'>=</span> <span class='va'>FPCURREFFMETHRC</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='https://forcats.tidyverse.org/reference/fct_collapse.html'>fct_collapse</a></span><span class='op'>(</span>
        <span class='st'>"Other modern methods"</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
          <span class='st'>"Male Sterilization"</span>, <span class='st'>"Female Sterilization"</span>, <span class='st'>"Female condom"</span>,
          <span class='st'>"Foam"</span>, <span class='st'>"Standard Days/Cycle Beads Method"</span>, <span class='st'>"Diaphragm"</span>,
          <span class='st'>"Lactational amenorrhea method (LAM)"</span>
        <span class='op'>)</span>,
        <span class='st'>"Implant"</span> <span class='op'>=</span> <span class='st'>"Implants"</span>,
        <span class='st'>"Injectable (IM)"</span> <span class='op'>=</span> <span class='st'>"Injectables (3 months)"</span>,
        <span class='st'>"Injectable (SC)"</span> <span class='op'>=</span> <span class='st'>"Injectables (Sayana Press)"</span>,
        <span class='st'>"Emergency contraception"</span> <span class='op'>=</span> <span class='st'>"Emergency Contraception"</span>,
      <span class='op'>)</span> 
  <span class='op'>)</span> 
</code></pre>
</div>
</div>
<p>Well now save the revised summary table as a data frame called
<code>mix_tbl</code>. Well also remove any of the rows that arent
necessary to calculate Modern Method Mix (where <code>MCP</code> is No
and No response or missing).</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mix_tbl</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='va'>FQWEIGHT</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>COUNTRY</span>, <span class='va'>INTFQMED</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarise</a></span><span class='op'>(</span>
    .groups <span class='op'>=</span> <span class='st'>"keep"</span>,
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>cur_data</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/as_survey_design.html'>as_survey_design</a></span><span class='op'>(</span>weights <span class='op'>=</span> <span class='va'>FQWEIGHT</span>, ids <span class='op'>=</span> <span class='va'>EAID</span>, strata <span class='op'>=</span> <span class='va'>STRATA</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/group_by.html'>group_by</a></span><span class='op'>(</span>MCP <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/as_factor.html'>as_factor</a></span><span class='op'>(</span><span class='va'>MCP</span><span class='op'>)</span>, <span class='va'>FPCURREFFMETHRC</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='http://gdfe.co/srvyr/reference/survey_mean.html'>survey_mean</a></span><span class='op'>(</span>prop <span class='op'>=</span> <span class='cn'>TRUE</span>, prop_method <span class='op'>=</span> <span class='st'>"logit"</span>, vartype <span class='op'>=</span> <span class='st'>"ci"</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='va'>MCP</span> <span class='op'>==</span> <span class='st'>"Yes"</span><span class='op'>)</span>

<span class='va'>mix_tbl</span>
</code></pre>
</div>
<pre><code># A tibble: 131  7
# Groups:   COUNTRY, INTFQMED [17]
   COUNTRY      INTFQMED MCP   FPCURREFFMETHRC            coef   `_low` `_upp`
   &lt;fct&gt;           &lt;dbl&gt; &lt;fct&gt; &lt;fct&gt;                     &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;
 1 Burkina Faso     1379 Yes   Other modern methods    0.0106  0.00517  0.0217
 2 Burkina Faso     1379 Yes   Emergency contraception 0.00163 0.000220 0.0120
 3 Burkina Faso     1379 Yes   Implant                 0.436   0.358    0.518 
 4 Burkina Faso     1379 Yes   Injectable (IM)         0.363   0.287    0.446 
 5 Burkina Faso     1379 Yes   IUD                     0.0194  0.00836  0.0445
 6 Burkina Faso     1379 Yes   Male condom             0.0349  0.0157   0.0758
 7 Burkina Faso     1379 Yes   Pill                    0.134   0.0986   0.181 
 8 Burkina Faso     1385 Yes   Other modern methods    0.0138  0.00680  0.0278
 9 Burkina Faso     1385 Yes   Emergency contraception 0.00463 0.00172  0.0124
10 Burkina Faso     1385 Yes   Implant                 0.367   0.272    0.473 
11 Burkina Faso     1385 Yes   Injectable (IM)         0.333   0.226    0.459 
12 Burkina Faso     1385 Yes   IUD                     0.0383  0.0194   0.0742
13 Burkina Faso     1385 Yes   Male condom             0.114   0.0744   0.169 
14 Burkina Faso     1385 Yes   Pill                    0.130   0.0947   0.177 
15 Burkina Faso     1395 Yes   Other modern methods    0.00325 0.000656 0.0159
16 Burkina Faso     1395 Yes   Emergency contraception 0.00502 0.00215  0.0117
17 Burkina Faso     1395 Yes   Implant                 0.444   0.382    0.508 
18 Burkina Faso     1395 Yes   Injectable (IM)         0.261   0.194    0.341 
19 Burkina Faso     1395 Yes   Injectable (SC)         0.0477  0.0297   0.0756
20 Burkina Faso     1395 Yes   IUD                     0.0203  0.0120   0.0342
#  with 111 more rows
#  Use `print(n = ...)` to see more rows</code></pre>
</div>
<p>With these revisions in place, were now ready to make our plot.
Weve showcased the excellent <a
href="https://corybrunson.github.io/ggalluvial">ggalluvial</a> package
in <a href="../2022-05-01-phase2-alluvial/index.html">earlier posts</a>,
so we wont dig into the details too deeply here. In short: we use <a
href="https://corybrunson.github.io/ggalluvial/reference/geom_stratum.html">geom_stratum</a>
to build stacked bars for each sample, and we use <a
href="https://corybrunson.github.io/ggalluvial/reference/geom_flow.html">geom_flow</a>
to show change over time. The argument <code>decreasing = FALSE</code>
ensures that the methods are arranged in order of popularity for each
sample.</p>
<p>A basic alluvial plot can be made like so:</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mix_plot</span> <span class='op'>&lt;-</span> <span class='va'>mix_tbl</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>INTFQMED</span>, 
    y <span class='op'>=</span> <span class='va'>coef</span>,
    fill <span class='op'>=</span> <span class='va'>FPCURREFFMETHRC</span>,
    stratum <span class='op'>=</span> <span class='va'>FPCURREFFMETHRC</span>,
    alluvium <span class='op'>=</span> <span class='va'>FPCURREFFMETHRC</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_wrap.html'>facet_wrap</a></span><span class='op'>(</span><span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise_all.html'>vars</a></span><span class='op'>(</span><span class='va'>COUNTRY</span><span class='op'>)</span>, ncol <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='http://corybrunson.github.io/ggalluvial/reference/geom_flow.html'>geom_flow</a></span><span class='op'>(</span>decreasing <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='http://corybrunson.github.io/ggalluvial/reference/geom_stratum.html'>geom_stratum</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>0</span>, width <span class='op'>=</span> <span class='fl'>2</span>, decreasing <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>

<span class='va'>mix_plot</span>
</code></pre>
</div>
<p><img src="method-mix-trends_files/figure-html5/unnamed-chunk-14-1.png" width="960" style="display: block; margin: auto;" /></p>
</div>
<p>As always, well apply our own custom theme and labels to clean-up
the final result. If you intend to make multiple plots with the same
theme, we recommend saving it as a function; well call ours
<code>theme_pma</code>.</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># Fonts </span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/yixuan/showtext'>showtext</a></span><span class='op'>)</span>
<span class='fu'>sysfonts</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sysfonts/man/font_add.html'>font_add</a></span><span class='op'>(</span>
  family <span class='op'>=</span> <span class='st'>"cabrito"</span>, 
  regular <span class='op'>=</span> <span class='st'>"../../fonts/cabritosansnormregular-webfont.ttf"</span>
<span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/pkg/showtext/man/showtext_auto.html'>showtext_auto</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># Fonts for geom_text</span>
<span class='fu'><a href='https://ggplot2.tidyverse.org/reference/update_defaults.html'>update_geom_defaults</a></span><span class='op'>(</span><span class='st'>"text"</span>, <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"cabrito"</span>, size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'># Theme </span>
<span class='va'>theme_pma</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='op'>)</span><span class='op'>{</span>
  <span class='va'>components</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>
    <span class='co'># Edit `theme_minimal`</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggtheme.html'>theme_minimal</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://ggplot2.tidyverse.org/reference/theme_get.html'>%+replace%</a></span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/theme.html'>theme</a></span><span class='op'>(</span>
      text <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>family <span class='op'>=</span> <span class='st'>"cabrito"</span>, size <span class='op'>=</span> <span class='fl'>12</span><span class='op'>)</span>,
      plot.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>26</span>, color <span class='op'>=</span> <span class='st'>"#00263A"</span>,
                                hjust <span class='op'>=</span> <span class='fl'>0</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>5</span><span class='op'>)</span><span class='op'>)</span>,
      plot.subtitle <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>0</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>b <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>, size <span class='op'>=</span> <span class='fl'>18</span><span class='op'>)</span>,
      plot.caption <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>hjust <span class='op'>=</span> <span class='fl'>1</span>, size <span class='op'>=</span> <span class='fl'>10</span>, margin <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>margin</a></span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>15</span><span class='op'>)</span><span class='op'>)</span>,
      plot.caption.position <span class='op'>=</span> <span class='st'>"plot"</span>,
      strip.background <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>,
      strip.text.x <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, hjust <span class='op'>=</span> <span class='fl'>1</span><span class='op'>)</span>,
      strip.text.y <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_text</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>14</span>, angle <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span>,
      panel.spacing <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/grid/unit.html'>unit</a></span><span class='op'>(</span><span class='fl'>1</span>, <span class='st'>"lines"</span><span class='op'>)</span>,
      legend.position <span class='op'>=</span> <span class='st'>"bottom"</span>,
      legend.title <span class='op'>=</span> <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/element.html'>element_blank</a></span><span class='op'>(</span><span class='op'>)</span>
    <span class='op'>)</span> ,
    
    <span class='co'># Add breaks by percent to y-axis, dates to x-axis</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_y_continuous</a></span><span class='op'>(</span>labels <span class='op'>=</span> <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/label_percent.html'>label_percent</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>,
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_continuous.html'>scale_x_continuous</a></span><span class='op'>(</span>
      breaks <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='fl'>2014</span><span class='op'>:</span><span class='fl'>2021</span>, <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>12</span><span class='op'>*</span><span class='op'>(</span><span class='va'>.x</span> <span class='op'>-</span> <span class='fl'>1900</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>1</span>, <span class='fl'>12</span><span class='op'>*</span><span class='op'>(</span><span class='va'>.x</span> <span class='op'>-</span> <span class='fl'>1900</span><span class='op'>)</span> <span class='op'>+</span> <span class='fl'>7</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span>
        <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span>,
      labels <span class='op'>=</span> <span class='fu'><a href='https://purrr.tidyverse.org/reference/map.html'>map</a></span><span class='op'>(</span><span class='fl'>2014</span><span class='op'>:</span><span class='fl'>2021</span>, <span class='op'>~</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Jan"</span>, <span class='va'>.x</span><span class='op'>)</span>, <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"Jul"</span>, <span class='va'>.x</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span>
        <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
        <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_wrap.html'>str_wrap</a></span><span class='op'>(</span><span class='fl'>3</span><span class='op'>)</span>
    <span class='op'>)</span>,
    
    <span class='co'># Custom colors copied from the PMA graphic</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_fill_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span>
      <span class='st'>"Implant"</span> <span class='op'>=</span> <span class='st'>"#C3B7D5"</span>,
      <span class='st'>"Injectable (IM)"</span> <span class='op'>=</span> <span class='st'>"#B7749A"</span>, 
      <span class='st'>"Injectable (SC)"</span> <span class='op'>=</span> <span class='st'>"#F6BFD8"</span>, 
      <span class='st'>"Pill"</span> <span class='op'>=</span> <span class='st'>"#171E48"</span>, 
      <span class='st'>"Male condom"</span> <span class='op'>=</span> <span class='st'>"#11687E"</span>, 
      <span class='st'>"IUD"</span> <span class='op'>=</span> <span class='st'>"#541E59"</span>, 
      <span class='st'>"Emergency contraception"</span> <span class='op'>=</span> <span class='st'>"#5B6160"</span>, 
      <span class='st'>"Other modern methods"</span> <span class='op'>=</span> <span class='st'>"#5BBBC9"</span>
    <span class='op'>)</span><span class='op'>)</span>,
    
    <span class='co'># Switch text labels from white to black for Implant &amp; Injectable (SC)</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/scale_manual.html'>scale_color_manual</a></span><span class='op'>(</span>values <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"white"</span>, <span class='st'>"black"</span><span class='op'>)</span><span class='op'>)</span>,
    
    <span class='co'># Add text labels for each method (if &gt; 3%)</span>
    <span class='fu'><a href='http://corybrunson.github.io/ggalluvial/reference/stat_stratum.html'>stat_stratum</a></span><span class='op'>(</span>
      geom <span class='op'>=</span> <span class='st'>"text"</span>,
      <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>
        label <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/if_else.html'>if_else</a></span><span class='op'>(</span>
          <span class='va'>coef</span> <span class='op'>&gt;</span> <span class='fl'>0.03</span>,
          <span class='fu'>scales</span><span class='fu'>::</span><span class='fu'><a href='https://scales.r-lib.org/reference/percent_format.html'>percent</a></span><span class='op'>(</span><span class='va'>coef</span>, <span class='fl'>1</span>, suffix <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>,
          <span class='st'>""</span>
        <span class='op'>)</span>,
        color <span class='op'>=</span> <span class='va'>FPCURREFFMETHRC</span> <span class='op'><a href='https://rdrr.io/r/base/match.html'>%in%</a></span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Implant"</span>, <span class='st'>"Injectable (SC)"</span><span class='op'>)</span>
      <span class='op'>)</span>,
      size <span class='op'>=</span> <span class='fl'>4</span>,
      show.legend <span class='op'>=</span> <span class='cn'>FALSE</span>,
      decreasing <span class='op'>=</span> <span class='cn'>FALSE</span>
    <span class='op'>)</span>,
    
    <span class='co'># Customize labels </span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>labs</a></span><span class='op'>(</span>
      x <span class='op'>=</span> <span class='cn'>NULL</span>, y <span class='op'>=</span> <span class='cn'>NULL</span>,
      title <span class='op'>=</span> <span class='st'>"Trends in Modern Method Mix"</span>,
      subtitle <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>
        <span class='st'>"Percent distribution of all women age 15-49 using modern"</span>,
        <span class='st'>"contraceptive methods by method and year"</span>
      <span class='op'>)</span>,
      caption <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span>
        <span class='st'>'"Other modern methods" includes male and female sterilization,'</span>,
        <span class='st'>'the female condom, contraceptive foam or jelly, the standard days'</span>,
        <span class='st'>'method/cycle beads, and diaphragm.'</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
        <span class='fu'><a href='https://stringr.tidyverse.org/reference/str_wrap.html'>str_wrap</a></span><span class='op'>(</span><span class='fl'>85</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
        <span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>'\n\nValues &lt; 3% not labelled.'</span><span class='op'>)</span>
    <span class='op'>)</span> 
  <span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>You can apply your theme to <code>mix_plot</code> like so:</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mix_plot</span> <span class='op'>+</span> <span class='fu'>theme_pma</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="method-mix-trends_files/figure-html5/unnamed-chunk-16-1.png" width="1344" data-distill-preview=1 style="display: block; margin: auto;" /></p>
</div>
<h1 id="disaggregation">Disaggregation</h1>
<p>Finally, youll also notice that PMA reports Modern Method Mix
disaggregated by marital status <a
href="https://pma.ipums.org/pma-action/variables/MARSTAT#codes_section">MARSTAT</a>.
You may also see Modern Method Mix disaggregated by age <a
href="https://pma.ipums.org/pma-action/variables/AGE#codes_section">AGE</a>,
education <a
href="https://pma.ipums.org/pma-action/variables/EDUCATTGEN#codes_section">EDUCATTGEN</a>,
or parity <a
href="https://pma.ipums.org/pma-action/variables/BIRTHEVENT#codes_section">BIRTHEVENT</a>.</p>
<p>Its easy to update our code for <code>mix_tbl</code> with these or
other variables, but its important to note that there may be zero
observations available for certain methods in some subgroups. In this
case, <a
href="http://gdfe.co/srvyr/reference/survey_mean.html">survey_mean</a>
will be unable to estimate the standard error for each proportion, and
youll receive a warning message like this one:</p>
<div class="layout-chunk" data-layout="l-page">
<pre><code>Warning: glm.fit: algorithm did not converge</code></pre>
</div>
<p>If youre simply constructing a graphic like the one we made above,
you can skip standard error estimation altogether by setting
<code>vartype = NULL</code>. Here, we demonstrate using a recoded
version of <code>MARSTAT</code>.</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mar_tbl</span> <span class='op'>&lt;-</span> <span class='va'>dat</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>mutate</a></span><span class='op'>(</span>
    MARSTAT <span class='op'>=</span> <span class='fu'><a href='https://dplyr.tidyverse.org/reference/case_when.html'>case_when</a></span><span class='op'>(</span>
      <span class='va'>MARSTAT</span> <span class='op'>==</span> <span class='st'>"Currently married"</span> <span class='op'>~</span> <span class='st'>"Married / Partnered"</span>,
      <span class='va'>MARSTAT</span> <span class='op'>==</span> <span class='st'>"Currently living with partner"</span> <span class='op'>~</span> <span class='st'>"Married / Partnered"</span>,
      <span class='cn'>TRUE</span> <span class='op'>~</span> <span class='st'>"Not Married / Partnered"</span>
    <span class='op'>)</span>,
    MARSTAT <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/as_factor.html'>as_factor</a></span><span class='op'>(</span><span class='va'>MARSTAT</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='va'>FQWEIGHT</span> <span class='op'>&gt;</span> <span class='fl'>0</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>COUNTRY</span>, <span class='va'>INTFQMED</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarise</a></span><span class='op'>(</span>
    .groups <span class='op'>=</span> <span class='st'>"keep"</span>,
    <span class='fu'><a href='https://dplyr.tidyverse.org/reference/context.html'>cur_data</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/as_survey_design.html'>as_survey_design</a></span><span class='op'>(</span>weights <span class='op'>=</span> <span class='va'>FQWEIGHT</span>, ids <span class='op'>=</span> <span class='va'>EAID</span>, strata <span class='op'>=</span> <span class='va'>STRATA</span><span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/group_by.html'>group_by</a></span><span class='op'>(</span>
        <span class='va'>MARSTAT</span>, <span class='co'># Add `MARSTAT`</span>
        MCP <span class='op'>=</span> <span class='fu'><a href='https://forcats.tidyverse.org/reference/as_factor.html'>as_factor</a></span><span class='op'>(</span><span class='va'>MCP</span><span class='op'>)</span>, 
        <span class='va'>FPCURREFFMETHRC</span>
      <span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
      <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise.html'>summarise</a></span><span class='op'>(</span><span class='fu'><a href='http://gdfe.co/srvyr/reference/survey_mean.html'>survey_mean</a></span><span class='op'>(</span>vartype <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span><span class='op'>)</span>
  <span class='op'>)</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='http://gdfe.co/srvyr/reference/dplyr_single.html'>filter</a></span><span class='op'>(</span><span class='va'>MCP</span> <span class='op'>==</span> <span class='st'>"Yes"</span><span class='op'>)</span>

<span class='va'>mar_tbl</span>
</code></pre>
</div>
<pre><code># A tibble: 255  6
# Groups:   COUNTRY, INTFQMED [17]
   COUNTRY      INTFQMED MARSTAT                 MCP   FPCURREFFMETHRC            coef
   &lt;fct&gt;           &lt;dbl&gt; &lt;fct&gt;                   &lt;fct&gt; &lt;fct&gt;                     &lt;dbl&gt;
 1 Burkina Faso     1379 Not Married / Partnered Yes   Other modern methods    0.0258 
 2 Burkina Faso     1379 Not Married / Partnered Yes   Emergency contraception 0.0191 
 3 Burkina Faso     1379 Not Married / Partnered Yes   Implant                 0.262  
 4 Burkina Faso     1379 Not Married / Partnered Yes   Injectable (IM)         0.195  
 5 Burkina Faso     1379 Not Married / Partnered Yes   IUD                     0.0516 
 6 Burkina Faso     1379 Not Married / Partnered Yes   Male condom             0.359  
 7 Burkina Faso     1379 Not Married / Partnered Yes   Pill                    0.0870 
 8 Burkina Faso     1379 Married / Partnered     Yes   Other modern methods    0.00920
 9 Burkina Faso     1379 Married / Partnered     Yes   Implant                 0.453  
10 Burkina Faso     1379 Married / Partnered     Yes   Injectable (IM)         0.378  
11 Burkina Faso     1379 Married / Partnered     Yes   IUD                     0.0164 
12 Burkina Faso     1379 Married / Partnered     Yes   Male condom             0.00457
13 Burkina Faso     1379 Married / Partnered     Yes   Pill                    0.139  
14 Burkina Faso     1385 Not Married / Partnered Yes   Other modern methods    0.0166 
15 Burkina Faso     1385 Not Married / Partnered Yes   Emergency contraception 0.0113 
16 Burkina Faso     1385 Not Married / Partnered Yes   Implant                 0.229  
17 Burkina Faso     1385 Not Married / Partnered Yes   Injectable (IM)         0.116  
18 Burkina Faso     1385 Not Married / Partnered Yes   IUD                     0.0112 
19 Burkina Faso     1385 Not Married / Partnered Yes   Male condom             0.480  
20 Burkina Faso     1385 Not Married / Partnered Yes   Pill                    0.136  
#  with 235 more rows
#  Use `print(n = ...)` to see more rows</code></pre>
</div>
<p>Only minor changes are needed to incorporate <code>MARSTAT</code>
into our graphic. Well switch from <a
href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a>
to <a
href="https://ggplot2.tidyverse.org/reference/facet_grid.html">facet_grid</a>,
where well add new column facets for <code>MARSTAT</code>.</p>
<div class="layout-chunk" data-layout="l-page">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>mar_tbl</span> <span class='op'><a href='http://gdfe.co/srvyr/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/ggplot.html'>ggplot</a></span><span class='op'>(</span><span class='fu'><a href='https://ggplot2.tidyverse.org/reference/aes.html'>aes</a></span><span class='op'>(</span>
    x <span class='op'>=</span> <span class='va'>INTFQMED</span>, 
    y <span class='op'>=</span> <span class='va'>coef</span>,
    fill <span class='op'>=</span> <span class='va'>FPCURREFFMETHRC</span>,
    stratum <span class='op'>=</span> <span class='va'>FPCURREFFMETHRC</span>,
    alluvium <span class='op'>=</span> <span class='va'>FPCURREFFMETHRC</span>
  <span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/facet_grid.html'>facet_grid</a></span><span class='op'>(</span>
    rows <span class='op'>=</span> <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise_all.html'>vars</a></span><span class='op'>(</span><span class='va'>COUNTRY</span><span class='op'>)</span>, 
    cols <span class='op'>=</span> <span class='fu'><a href='http://gdfe.co/srvyr/reference/summarise_all.html'>vars</a></span><span class='op'>(</span><span class='va'>MARSTAT</span><span class='op'>)</span> <span class='co'># Add `MARSTAT`</span>
  <span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='http://corybrunson.github.io/ggalluvial/reference/geom_flow.html'>geom_flow</a></span><span class='op'>(</span>decreasing <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'><a href='http://corybrunson.github.io/ggalluvial/reference/geom_stratum.html'>geom_stratum</a></span><span class='op'>(</span>size <span class='op'>=</span> <span class='fl'>0</span>, width <span class='op'>=</span> <span class='fl'>2</span>, decreasing <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>theme_pma</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="method-mix-trends_files/figure-html5/unnamed-chunk-19-1.png" width="1344" style="display: block; margin: auto;" /></p>
</div>
<p>In both countries, theres quite a big difference in the popularity
of modern methods between married / partnered and non-partnered women.
Of course, the demand for modern family planning methods is probably
very different for women in each of these subgroups. In the next few
weeks, well dig deeper into issues surrounding measurement of demand
for family planning, and related measures like <a
href="https://pma.ipums.org/pma-action/variables/UNMETNEED#codes_section">unmet
need</a>.</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<section class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p><a
href="https://www.data4impactproject.org/prh/family-planning/method-choice/method-mix/">USAID
- Data for Impact</a><a href="#fnref1" class="footnote-back"
role="doc-backlink"></a></p></li>
<li id="fn2" role="doc-endnote"><p>IPUMS PMA includes a variable <a
href="https://pma.ipums.org/pma-action/variables/INTFQCMC">INTFQCMC</a>,
but it is not currently available for all samples.<a href="#fnref2"
class="footnote-back" role="doc-backlink"></a></p></li>
<li id="fn3" role="doc-endnote"><p>Not included in the PMA graphic
above<a href="#fnref3" class="footnote-back"
role="doc-backlink"></a></p></li>
</ol>
</section>
<!--radix_placeholder_article_footer-->
<div class="article-footer">
  <p class="social_footer">
    <span class="disqus-comments">
      <i class="fas fa-comments"></i>
      &nbsp;
      <span class="disqus-comment-count" data-disqus-identifier="posts/2022-08-15-method-mix-trends/">Comment on this article</span>
    </span>
    <span class="article-sharing">
      Share: &nbsp;
      <a href="https://twitter.com/share?text=Trends%20in%20Modern%20Contraceptive%20Method%20Mix&amp;url=https%3A%2F%2Fipums.github.io%2Fpma-data-hub%2Fposts%2F2022-08-15-method-mix-trends%2F" aria-label="share on twitter">
        <i class="fab fa-twitter" aria-hidden="true"></i>
      </a>
      <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3A%2F%2Fipums.github.io%2Fpma-data-hub%2Fposts%2F2022-08-15-method-mix-trends%2F&amp;title=Trends%20in%20Modern%20Contraceptive%20Method%20Mix" aria-label="share on linkedin">
        <i class="fab fa-linkedin" aria-hidden="true"></i>
      </a>
    </span>
  </p>
  <script id="dsq-count-scr" src="https://pma-data-hub.disqus.com/count.js" async></script>
  <div id="disqus_thread" class="hidden"></div>
  <script type="text/javascript" cookie-consent="functionality">
var disqus_config = function () {
  this.page.url = 'https://ipums.github.io/pma-data-hub/posts/2022-08-15-method-mix-trends/';
  this.page.identifier = 'posts/2022-08-15-method-mix-trends/';
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = 'https://pma-data-hub.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
</script>
</div>
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>


<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom">
  <h3 id="updates-and-corrections">Corrections</h3>
  <p>If you see mistakes or want to suggest changes, please <a href="https://github.com/ipums/pma-data-hub/issues/new">create an issue</a> on the source repository.</p>
</div>
<!--/radix_placeholder_appendices-->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--radix_placeholder_navigation_after_body--><html><body>
<div class="distill-site-nav distill-site-footer">
<p>Developed by <a href="https://www.ipums.org">IPUMS</a> at the
University of Minnesota</p>
<p>Licensed under the
<a href="https://www.mozilla.org/en-US/MPL/2.0/">Mozilla Public License
Version 2.0</a></p>
<p>Site built with <a href="https://rstudio.github.io/distill/">Distill
for R Markdown</a></p>
</div>
<!--/radix_placeholder_navigation_after_body-->
</body></html>


</body>

</html>
